<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Kemoenik Official Store</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        :root {
            --primary: #10B981;
            --primary-dark: #059669;
            --bg-soft: #F5F7FA;
            --text-main: #1F2937;
            --shadow-soft: 0 4px 12px rgba(0, 0, 0, 0.03);
            --accent: #F59E0B;
            --danger: #EF4444;
        }

        * { font-family: 'Plus Jakarta Sans', sans-serif; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        html { -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; scroll-behavior: smooth; }
        
        body { 
            background: linear-gradient(180deg, #FFFFFF 0%, #F0FDF4 50%, #ECFDF5 100%);
            background-attachment: fixed;
            color: var(--text-main); 
            overscroll-behavior: none; 
            position: relative;
            min-height: 100vh;
        }

        body.no-scroll { overflow: hidden; }

        .modal-content { padding-bottom: 100px; }
        *, *::before, *::after { touch-action: manipulation; }
        ::-webkit-scrollbar { width: 3px; height: 3px;}
        ::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 10px; }
        ::-webkit-scrollbar-track { background: transparent; }

        /* KATEGORI HORIZONTAL */
        #category-list {
            display: flex !important;
            flex-direction: row !important;
            overflow-x: auto;
            gap: 0 !important;
            padding-bottom: 8px;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }
        #category-list::-webkit-scrollbar { display: none; }
        
        .category-text {
            font-size: 14px;
            font-weight: 500;
            color: #6B7280;
            cursor: pointer;
            padding: 8px 16px !important;
            transition: all 0.2s ease;
            white-space: nowrap;
            border-right: 1px solid #E5E7EB;
            flex-shrink: 0;
        }
        .category-text:last-child { border-right: none; }
        .category-text.active {
            color: var(--primary-dark);
            font-weight: 700;
            background: linear-gradient(180deg, transparent 90%, var(--primary) 90%);
        }

        /* Modal Styles */
        .modal-overlay { 
            position: fixed; 
            inset: 0; 
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(4px);
            z-index: 1000; 
            display: none; 
            align-items: flex-end;
            justify-content: center; 
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .modal-overlay.active { display: flex; opacity: 1; align-items: flex-end; }
        
        .modal-content { 
            background: white; 
            width: 100%; 
            max-width: 500px; 
            max-height: 92dvh;
            border-radius: 24px 24px 0 0; 
            overflow-y: auto;
            overflow-x: hidden;
            position: relative; 
            animation: slideUp 0.35s cubic-bezier(0.16, 1, 0.3, 1); 
            box-shadow: 0 -10px 40px rgba(0,0,0,0.15);
            -webkit-overflow-scrolling: touch;
        }
        @keyframes slideUp { from { transform: translateY(30%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        
        #invoiceModal .modal-content {
            background: linear-gradient(180deg, #f3f4f6 0%, #e5e7eb 100%);
            border-radius: 24px 24px 0 0;
            padding: 20px 10px;
        }

        .invoice-card {
            background: white;
            width: 100%;
            max-width: 420px;
            margin: 0 auto;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            padding: 30px 25px;
            position: relative;
            overflow: hidden;
        }

        .input-style { 
            width: 100%; 
            border: 2px solid #E5E7EB; 
            padding: 14px 16px;
            border-radius: 14px;
            font-size: 16px;
            margin-bottom: 12px; 
            outline: none; 
            background: #FFFFFF; 
            transition: all 0.2s;
        }
        .input-style:focus { 
            border-color: var(--primary); 
            box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.1); 
            background: white;
        }
        .btn-primary { 
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); 
            color: white; 
            padding: 14px 20px; 
            border-radius: 14px; 
            font-weight: 700; 
            width: 100%; 
            border: none; 
            transition: all 0.2s; 
            box-shadow: 0 4px 14px rgba(16, 185, 129, 0.3);
        }
        .btn-primary:active { transform: scale(0.98); box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3); }

        /* Bank Card Styles */
        .bank-card-modern {
            background: linear-gradient(145deg, #ffffff 0%, #fafafa 100%);
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.03);
            position: relative;
            overflow: hidden;
        }
        .bank-card-modern::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; }
        .bank-card-bri::before { background: linear-gradient(90deg, #00529C, #0080c7); }
        .bank-card-dana::before { background: linear-gradient(90deg, #108ee9, #00bfff); }
        .bank-card-seabank::before { background: linear-gradient(90deg, #00b14f, #40c752); }

        .bank-logo-container { display: flex; align-items: center; gap: 10px; margin-bottom: 8px; }
        .bank-logo-box { padding: 4px 8px; border-radius: 4px; display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 10px; color: white; }
        .logo-bri { background: linear-gradient(135deg, #00529C, #0070c7); }
        .logo-dana { background: linear-gradient(135deg, #108ee9, #00bfff); }
        .logo-seabank { background: linear-gradient(135deg, #00b14f, #40c752); }
        .bank-name-modern { font-size: 12px; font-weight: 700; color: #374151; letter-spacing: 0.5px; }
        
        .bank-number-container { display: flex; align-items: center; justify-content: space-between; gap: 8px; background: #f9fafb; padding: 8px 12px; border-radius: 8px; border: 1px solid #e5e7eb; }
        .bank-number-modern { font-family: 'Courier New', Courier, monospace; font-size: 15px; font-weight: 700; color: #1f2937; letter-spacing: 0.5px; }
        .copy-btn { background: var(--primary); color: white; border: none; padding: 4px 10px; border-radius: 6px; font-size: 10px; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .copy-btn:active { transform: scale(0.95); background: var(--primary-dark); }
        .bank-owner-badge { display: inline-flex; align-items: center; gap: 4px; margin-top: 6px; font-size: 10px; color: #166534; }

        /* Product Grid */
        #product-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
        
        .product-card {
            background: white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 2px 12px rgba(0,0,0,0.06);
            border: 1px solid rgba(0,0,0,0.04);
            display: flex;
            flex-direction: column;
            height: 100%;
            position: relative;
            transition: all 0.3s ease;
        }
        .product-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.1);
        }
        
        .product-img-wrapper { position: relative; width: 100%; padding-top: 100%; background: #f8f9fa; overflow: hidden; }
        .product-img { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s ease; }
        .product-card:hover .product-img { transform: scale(1.08); }

        .flash-sale-badge {
            position: absolute;
            top: 0;
            left: 0;
            background: linear-gradient(135deg, #EF4444 0%, #DC2626 100%);
            color: white;
            font-size: 9px;
            font-weight: 800;
            padding: 4px 10px;
            border-radius: 0 0 10px 0;
            z-index: 10;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }
        
        .discount-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            background: linear-gradient(135deg, #F59E0B 0%, #D97706 100%);
            color: white;
            font-size: 10px;
            font-weight: 800;
            padding: 3px 8px;
            border-radius: 8px;
            z-index: 10;
        }

        .wishlist-btn-card {
            position: absolute;
            bottom: 8px;
            right: 8px;
            width: 30px;
            height: 30px;
            background: rgba(255,255,255,0.95);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 5;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            transition: all 0.2s;
            border: none;
        }
        .wishlist-btn-card:active { transform: scale(0.9); }
        .wishlist-btn-card svg { width: 16px; height: 16px; transition: all 0.2s; }
        .wishlist-btn-card.active svg { fill: #ef4444; stroke: #ef4444; }

        .product-info { padding: 12px; display: flex; flex-direction: column; flex-grow: 1; }
        .product-title { 
            font-size: 12px; 
            font-weight: 600; 
            color: #333; 
            line-height: 1.4; 
            margin-bottom: 6px; 
            display: -webkit-box; 
            -webkit-line-clamp: 2; 
            -webkit-box-orient: vertical; 
            overflow: hidden; 
            height: 2.8em; 
        }
        
        .product-meta {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 6px;
            font-size: 10px;
            color: #6B7280;
        }
        .rating-stars {
            display: flex;
            align-items: center;
            gap: 2px;
            color: #F59E0B;
            font-weight: 600;
        }
        .sold-count { color: #9CA3AF; }
        
        .product-price { 
            font-size: 15px; 
            font-weight: 800; 
            color: var(--primary-dark);
            margin-bottom: 4px; 
        }
        .product-price-original {
            font-size: 11px;
            color: #9CA3AF;
            text-decoration: line-through;
            margin-bottom: 8px;
        }
        
        .product-btn { 
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white; 
            border: none; 
            width: 100%; 
            padding: 10px; 
            border-radius: 12px; 
            font-size: 11px; 
            font-weight: 700; 
            cursor: pointer;
            transition: all 0.2s;
            margin-top: auto;
        }
        .product-btn:active { transform: scale(0.98); }

        .quick-link { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            background: white; 
            padding: 12px 0; 
            border-radius: 16px; 
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            transition: all 0.2s;
            border: 1px solid rgba(0,0,0,0.04);
        }
        .quick-link:active { transform: scale(0.95); }

        /* Slider */
        .slider-container {
            position: relative;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }
        #hero-slider, #category-slider {
            display: flex;
            transition: transform 0.5s ease;
        }
        .slide-item {
            min-width: 100%;
            position: relative;
        }
        .slide-item img {
            width: 100%;
            height: 180px;
            object-fit: cover;
        }
        @media (min-width: 640px) {
            .slide-item img { height: 240px; }
        }
        .slider-dots {
            position: absolute;
            bottom: 12px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 6px;
            z-index: 10;
        }
        .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255,255,255,0.5);
            cursor: pointer;
            transition: all 0.3s;
        }
        .dot.active {
            background: white;
            width: 24px;
            border-radius: 4px;
        }

        /* Promo Container */
        #promo-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }
        @media (min-width: 480px) {
            #promo-container { grid-template-columns: repeat(3, 1fr); }
        }
        .promo-card {
            background: white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 2px 12px rgba(0,0,0,0.06);
            border: 1px solid rgba(239, 68, 68, 0.1);
            cursor: pointer;
            transition: transform 0.2s;
        }
        .promo-card:active { transform: scale(0.98); }
        .promo-card img {
            width: 100%;
            height: 120px;
            object-fit: cover;
        }
        .promo-content {
            padding: 10px;
        }
        .promo-title {
            font-size: 12px;
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .promo-price {
            font-size: 14px;
            font-weight: 800;
            color: var(--danger);
        }
        .promo-old-price {
            font-size: 10px;
            color: #9CA3AF;
            text-decoration: line-through;
            margin-left: 4px;
        }

        /* Gallery Product Detail */
        #product-gallery {
            position: relative;
            overflow: hidden;
            background: #f3f4f6;
        }
        #gallery-slider {
            display: flex;
            transition: transform 0.3s ease;
        }
        #gallery-slider img {
            min-width: 100%;
            aspect-ratio: 1;
            object-fit: cover;
        }
        .gallery-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            border: none;
            background: rgba(255,255,255,0.5);
            cursor: pointer;
            transition: all 0.3s;
        }
        .gallery-dot.active {
            background: white;
            width: 20px;
            border-radius: 4px;
        }
        .gallery-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.9);
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }
        .gallery-nav:active { transform: translateY(-50%) scale(0.95); }
        .gallery-prev { left: 12px; }
        .gallery-next { right: 12px; }

        /* Print Styles */
        @media print {
            body * { visibility: hidden; }
            #invoiceModal, #invoiceModal * { visibility: visible; }
            #invoiceModal { position: absolute; inset: 0; width: 100%; background: white; display: block !important; }
            #invoiceModal > .modal-content { max-height: none !important; overflow: visible !important; border-radius: 0; box-shadow: none; max-width: 100%; margin: 0; padding: 0; background: white; }
            .invoice-card { box-shadow: none !important; border: none !important; max-width: 100% !important; margin: 0 !important; border-radius: 0 !important; padding: 20px !important; }
            .no-print { display: none !important; }
            #invoice-container { width: 100%; margin: 0; padding: 0; background: white; color: black; height: auto !important; overflow: visible !important; }
        }
    </style>
</head>
<body>

    <!-- Floating Tracking Button -->
    <div onclick="openTracking()" class="fixed bottom-24 right-4 bg-white p-3 rounded-full shadow-lg z-40 cursor-pointer hover:shadow-xl transition-all border border-gray-100" style="box-shadow: 0 4px 20px rgba(0,0,0,0.1);">
        <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"/></svg>
    </div>

    <!-- ==========================================
         [GANTI] HEADER - LOGO & NAMA TOKO
         ========================================== -->
    <header class="sticky top-0 z-50 bg-white/90 backdrop-blur-xl border-b border-gray-100" style="box-shadow: 0 2px 20px rgba(0,0,0,0.04);">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <!-- [GANTI] URL LOGO TOKO DI SINI -->
                <img src="https://i.postimg.cc/3JZ3Y0K0/Logo-Kemoenik-jpg.jpg" alt="Logo" class="h-10 w-10 rounded-xl object-cover shadow-sm border border-gray-100">
                <div>
                    <!-- [GANTI] NAMA TOKO DI SINI -->
                    <h1 class="text-base font-bold text-gray-800 leading-tight" id="store-name">Kemoenik Official Store</h1>
                    <p class="text-[10px] text-gray-400 font-medium">Official Partner</p>
                </div>
            </div>
            <div class="flex items-center gap-1">
                <button onclick="toggleSearch()" class="p-2 hover:bg-gray-100 rounded-full transition">
                    <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
                </button>
                <button onclick="openWishlist()" class="relative p-2 hover:bg-gray-100 rounded-full transition">
                    <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/></svg>
                    <span id="wish-count-head" class="absolute -top-0.5 -right-0.5 bg-red-500 text-white text-[9px] w-4 h-4 rounded-full items-center justify-center hidden">0</span>
                </button>
                <button onclick="openCart()" class="relative p-2 hover:bg-gray-100 rounded-full transition">
                    <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"/></svg>
                    <span id="sticky-count" class="absolute -top-0.5 -right-0.5 text-white text-[9px] w-4 h-4 rounded-full flex items-center justify-center" style="background: var(--primary);">0</span>
                </button>
            </div>
        </div>
        <div id="search-bar" class="px-4 pb-3 hidden">
            <input type="text" id="search-input" class="input-style mb-0" placeholder="Cari produk..." onkeyup="searchProducts()">
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 pb-24 pt-4">
        
        <!-- ==========================================
             [GANTI] SLIDER HERO - 5 GAMBAR PROMO
             Cara dapat link: Upload ke postimg.cc atau imgur
             ========================================== -->
        <section class="mb-5 slider-container">
            <div id="hero-slider"></div>
            <div class="slider-dots" id="slider-dots"></div>
        </section>

        <!-- Quick Links -->
        <section class="mb-5 grid grid-cols-4 gap-3">
            <!-- [GANTI] LINK INSTAGRAM -->
            <a href="https://instagram.com/kemoenik26" target="_blank" class="quick-link">
                <svg class="w-6 h-6 mb-1" style="color: #E4405F;" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg>
                <span class="text-[10px] text-gray-600 font-medium">Instagram</span>
            </a>
            
            <!-- [GANTI] ALAMAT TOKO -->
            <a href="#" onclick="event.preventDefault(); alert('Kp Cibubuay, Desa Cibodas, Kec. Pasirjambu, Kab. Bandung')" class="quick-link">
                <svg class="w-6 h-6 text-blue-500 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
                <span class="text-[10px] text-gray-600 font-medium">Lokasi</span>
            </a>
            
            <!-- [GANTI] LINK TIKTOK -->
            <a href="https://tiktok.com/@kemoenik" target="_blank" class="quick-link">
                <svg class="w-6 h-6 text-gray-800 mb-1" fill="currentColor" viewBox="0 0 24 24"><path d="M19.59 6.69a4.83 4.83 0 01-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 01-5.2 1.74 2.89 2.89 0 012.31-4.64 2.93 2.93 0 01.88.13V9.4a6.84 6.84 0 00-1-.05A6.33 6.33 0 005 20.1a6.34 6.34 0 0010.86-4.43v-7a8.16 8.16 0 004.77 1.52v-3.4a4.85 4.85 0 01-1-.1z"/></svg>
                <span class="text-[10px] text-gray-600 font-medium">TikTok</span>
            </a>
            
            <a id="wa-btn-header" href="#" class="quick-link">
                <svg class="w-6 h-6 mb-1" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="16" cy="16" r="14" fill="#25D366"/>
                    <path d="M21.5 18.5c-.3-.2-1.7-.9-2-.9-.3-.1-.5-.1-.7.2-.2.3-.8 1-.9 1.1-.2.2-.3.2-.6.1-.3-.2-1.3-.5-2.4-1.5-.9-.8-1.5-1.8-1.7-2.1-.2-.3 0-.5.1-.6.1-.1.3-.3.4-.5.1-.2.2-.3.3-.5.1-.2.1-.4 0-.5-.1-.2-.6-1.5-.9-2-.2-.5-.5-.4-.7-.4-.2 0-.4 0-.6 0-.2 0-.5.1-.8.4-.3.3-1 1-1 2.4s1 2.8 1.1 3c.1.2 2 3.1 4.9 4.3.7.3 1.2.5 1.6.6.7.2 1.3.2 1.8.1.5-.1 1.6-.7 1.8-1.3.2-.6.2-1.2.2-1.3-.1-.1-.3-.2-.6-.3z" fill="white"/>
                    <path d="M16 6.5c5.2 0 9.5 4.3 9.5 9.5S21.2 25.5 16 25.5c-1.7 0-3.3-.4-4.7-1.2l-.3-.2-3.1.8.8-3-.2-.3c-.9-1.5-1.5-3.2-1.5-5.1 0-5.2 4.3-9.5 9.5-9.5m0-1.5C9.6 5 5 9.6 5 15.5c0 2.2.6 4.3 1.7 6.1L5 27l5.6-1.8c1.7.9 3.6 1.4 5.7 1.4 6.1 0 11-4.9 11-11S22.1 5 16 5z" fill="white"/>
                </svg>
                <span class="text-[10px] text-gray-600 font-medium">Chat</span>
            </a>
        </section>

        <!-- Kategori Horizontal -->
        <section class="mb-4">
            <h2 class="text-sm font-bold text-gray-700 mb-2">KATEGORI PRODUK</h2>
            <div id="category-list"></div>
        </section>

        <!-- ==========================================
             [GANTI] SLIDER TESTIMONI - 20 GAMBAR
             ========================================== -->
        <section class="mb-6">
            <h2 class="text-sm font-bold text-gray-700 mb-3">TESTIMONI</h2>
            <div class="slider-container">
                 <div id="category-slider"></div>
                 <div class="slider-dots" id="category-slider-dots"></div>
            </div>
        </section>

        <!-- ==========================================
             [GANTI] PROMO SPESIAL - 3 PRODUK
             ========================================== -->
        <section class="mb-6">
            <h2 class="text-sm font-bold text-red-600 mb-3">üî• PROMO SPESIAL</h2>
            <div id="promo-container"></div>
        </section>

        <!-- Products -->
        <section id="product-section">
            <div id="product-grid"></div>
        </section>
    </main>

    <!-- ==========================================
         [GANTI] FOOTER - INFO TOKO
         ========================================== -->
    <footer class="bg-white text-gray-500 mt-8 shadow-inner pb-24 border-t border-gray-100">
        <div class="container mx-auto px-4 py-8 text-center">
            <!-- [GANTI] LOGO FOOTER -->
            <img src="https://i.postimg.cc/3JZ3Y0K0/Logo-Kemoenik-jpg.jpg" class="h-14 w-14 rounded-full mx-auto mb-3 shadow-md border-2 border-gray-100">
            <h3 class="font-bold text-gray-700 mb-1">Kemoenik Official Store</h3>
            <!-- [GANTI] ALAMAT LENGKAP -->
            <p class="text-xs max-w-xs mx-auto leading-relaxed opacity-70">Kp Cibubuay, Desa Cibodas, Kec. Pasirjambu, Kab. Bandung, 40972</p>
            <p class="text-[10px] text-gray-400 mt-3">Produk Berkualitas & Terpercaya</p>
        </div>
    </footer>

    <!-- Sticky Cart Bar -->
    <div id="sticky-bar" class="fixed bottom-0 left-0 right-0 bg-white/95 backdrop-blur-md shadow-2xl p-3 z-40 hidden border-t border-gray-100">
        <div class="flex items-center justify-between max-w-lg mx-auto">
            <div>
                <span class="text-xs text-gray-500"><span id="sticky-items">0</span> item</span>
                <p class="font-bold text-sm text-gray-800" id="sticky-total">Rp 0</p>
            </div>
            <button onclick="openCart()" class="btn-primary py-2.5 px-6 text-sm">Keranjang</button>
        </div>
    </div>

    <!-- Modals -->
    <div id="detail-modal" class="modal-overlay"><div class="modal-content" id="detail-content"></div></div>
    <div id="cart-modal" class="modal-overlay"><div class="modal-content p-5" id="cart-content"></div></div>
    <div id="checkout-modal" class="modal-overlay"><div class="modal-content p-5" id="checkout-content"></div></div>
    
    <div id="invoiceModal" class="modal-overlay">
        <div class="modal-content">
            <div id="invoice-container"></div>
            <div class="sticky bottom-0 p-4 bg-gray-50 border-t no-print flex flex-col gap-2">
                <div class="flex gap-2">
                    <button onclick="printInvoice()" class="btn-primary bg-gray-800 flex-1 flex items-center justify-center gap-2 py-3 text-sm" style="background: #1F2937;">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/></svg>
                        Cetak
                    </button>
                    <button onclick="sendInvoiceWA()" class="btn-primary flex-1 flex items-center justify-center gap-2 py-3 text-sm" style="background: #25D366;">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>
                        WhatsApp
                    </button>
                </div>
                <div class="flex gap-2 mt-1">
                    <button onclick="editInvoice()" class="flex-1 text-center text-xs text-blue-600 hover:underline py-2 border-r border-gray-200">Edit Pesanan</button>
                    <button onclick="closeInvoice()" class="flex-1 text-center text-xs text-gray-400 hover:text-gray-600 py-2">Tutup</button>
                </div>
            </div>
        </div>
    </div>

    <div id="wishlist-modal" class="modal-overlay"><div class="modal-content p-5" id="wishlist-content"></div></div>
    <div id="tracking-modal" class="modal-overlay"><div class="modal-content p-5" id="tracking-content"></div></div>

    <script>
        // ==========================================
        // [GANTI SEMUA INI] KONFIGURASI DATA UTAMA
        // ==========================================
        
        const CONFIG = {
            // [GANTI] Nama Toko
            storeName: "Kemoenik Official Store",
            
            // [GANTI] Alamat Toko
            storeAddress: "Kp Cibubuay, Desa Cibodas, Kec. Pasirjambu, Kab. Bandung, 40972",
            
            // [GANTI] Nomor WhatsApp (format: 62xxxxxxxxxx, tanpa + atau spasi)
            whatsappNumber: "6281546450547",
            
            // [GANTI] Data Rekening Bank
            bankAccounts: [
                { bank: "BRI", number: "000501168248506", name: "DANI RAMDANI", logoClass: "logo-bri", cardClass: "bank-card-bri" },
                { bank: "DANA", number: "081546450547", name: "DANI RAMDANI", logoClass: "logo-dana", cardClass: "bank-card-dana" },
                { bank: "SeaBank", number: "901851870313", name: "DANI RAMDANI", logoClass: "logo-seabank", cardClass: "bank-card-seabank" }
            ],
            
            // [GANTI] Kupon Diskon
            coupons: [ 
                { code: "KEMOENIK26", type: "shipping", value: 15000, minPurchase: 120000 } 
            ],
            
            // [GANTI] Kategori Produk
            categories: [ 
                { id: 'all', name: "Semua" }, 
                { id: 'calc', name: "Calculator" }, 
                { id: 'kapsul', name: "Kapsul" }, 
                { id: 'teh', name: "Teh" },
                { id: 'lainnya', name: "Lainnya" }
            ],

            // ==========================================
            // [GANTI] SLIDER HERO - 5 GAMBAR BANNER
            // Upload gambar ke postimg.cc, copy link "Direct link"
            // Ukuran ideal: 800x400 pixel
            // ==========================================
            sliders: [
                "https://i.postimg.cc/CKnYvKCP/5.png",    // [GANTI] Gambar 1
                "https://i.postimg.cc/tJkH1nyb/4.png",    // [GANTI] Gambar 2
                "https://i.postimg.cc/7Zfy6LRv/3.png",    // [GANTI] Gambar 3
                "https://i.postimg.cc/kMhxtJMk/1.png",    // [GANTI] Gambar 4
                "https://i.postimg.cc/P51Zc1Wz/2.png"    // [GANTI] Gambar 5
            ],

            // ==========================================
            // [GANTI] SLIDER TESTIMONI - 20 GAMBAR
            // Upload screenshot testimoni customer ke postimg.cc
            // Ukuran ideal: 800x400 pixel
            // ==========================================
            testimoniSliders: [
                "https://i.postimg.cc/ZqytPK6v/1.png1",   // [GANTI]
                "https://i.postimg.cc/WbpBW70Y/2.png",   // [GANTI]
                "https://i.postimg.cc/zG64fZ4z/3.png",   // [GANTI]
                "https://i.postimg.cc/kGTp3kx3/4.png",   // [GANTI]
                "https://i.postimg.cc/YSQDq41q/5.png",   // [GANTI]
                "https://i.postimg.cc/LXRCqHTG/6.png",   // [GANTI]
                "https://i.postimg.cc/GtmXQq6P/7.png",   // [GANTI]
                "https://i.postimg.cc/sD1nGHp6/8.png",   // [GANTI]
                "https://i.postimg.cc/QdT00BYw/9.png",   // [GANTI]
                "https://i.postimg.cc/R01GxkBJ/10.png",  // [GANTI]
                "https://i.postimg.cc/1tJHfD4w/11.png",  // [GANTI]
                "https://i.postimg.cc/BZ7p35dT/12.png",  // [GANTI]
                "https://i.postimg.cc/7YCVZG48/13.png",  // [GANTI]
                "https://i.postimg.cc/m20SzLZY/14.png",  // [GANTI]
                "https://i.postimg.cc/sg745kvV/15.png",  // [GANTI]
                "https://i.postimg.cc/FKvgpTLS/16.png",  // [GANTI]
                "https://i.postimg.cc/VvJjvT3H/17.png",  // [GANTI]
                "https://i.postimg.cc/KcWPwGT2/18.png",  // [GANTI]
                "https://i.postimg.cc/jS0zqMvg/19.png",  // [GANTI]
                "https://i.postimg.cc/dV2GhGxD/20.png"   // [GANTI]
            ],

            // ==========================================
            // [GANTI] PROMO SPESIAL - 3 PRODUK
            // ==========================================
            promoProducts: [
                {
                    id: "promo1",
                    name: "CALCULATOR FAT LOSS - Hitung Kalori Harian",           // [GANTI] Nama promo 1
                    price: 18000,                              // [GANTI] Harga promo 1
                    oldPrice: 18000,                           // [GANTI] Harga normal 1
                    // [GANTI] Gambar promo 1 (ukuran 400x400)
                    image: "https://i.postimg.cc/mktvmLHT/Desain-tanpa-judul-(1).png"
                },
                {
                    id: "promo2",
                    name: "Teh Detox Herbal",                   // [GANTI] Nama promo 2
                    price: 95000,                               // [GANTI] Harga promo 2
                    oldPrice: 150000,                           // [GANTI] Harga normal 2
                    // [GANTI] Gambar promo 2 (ukuran 400x400)
                    image: "https://placehold.co/400x400/d1fae5/065f46?text=Promo+2"
                },
                {
                    id: "promo3",                               // [GANTI] Promo 3 (BARU)
                    name: "Paket Combo Diet",                   // [GANTI] Nama promo 3
                    price: 199000,                              // [GANTI] Harga promo 3
                    oldPrice: 350000,                           // [GANTI] Harga normal 3
                    // [GANTI] Gambar promo 3 (ukuran 400x400)
                    image: "https://placehold.co/400x400/fef3c7/b45309?text=Promo+3"
                }
            ],

            // ==========================================
            // [GANTI] DAFTAR PRODUK - MASING-MASING 5 GAMBAR
            // Cara tambah gambar: Tambah URL di array images (minimal 5)
            // ==========================================
            products: [
                { 
                    id: 1, 
                    category: 'calc', 
                    name: "(Gratis Ongkir) CALCULATOR FAT LOSS (Bentuk Website) - Hitung Kalori Harian", 
                    price: 40000,
                    active: true,
                    originalPrice: 40000,
                    discount: 50, 
                    flashSale: true,
                    // [GANTI] 5 GAMBAR PRODUK - Tambah link di sini
                    images: [
                        "https://i.postimg.cc/MHJQ89Wz/katalog-1.jpg",  // [GANTI] Gambar 1 (utama)
                        "https://i.postimg.cc/htsqBv0R/katalog-2.jpg",  // [GANTI] Gambar 2
                        "https://i.postimg.cc/XJDfnQBb/1.png",  // [GANTI] Gambar 3
                        "https://i.postimg.cc/br71trTj/2.png",  // [GANTI] Gambar 4
                        "https://i.postimg.cc/28WQfdzt/3.png"   // [GANTI] Gambar 5
                    ], 
                    sold: 2547, 
                    rating: 4.9, 
                    desc: `
                    üî• CALFATLOSS ‚Äì Laporan Diet & Kalori Personal (PDF)
                    
                    Mau turun berat badan tapi bingung mulai dari mana?
                    Capek diet tapi nggak tahu harus makan berapa?
                    
                    Sekarang nggak perlu nebak-nebak lagi.
                    Dapatkan laporan analisis diet personal berdasarkan data tubuh & target kamu sendiri.
                    
                    üìä APA YANG KAMU DAPAT?
                    ‚úÖ Hitung BMR (Metabolisme Basal)
                    ‚úÖ Hitung TDEE (Kalori Pemeliharaan)
                    ‚úÖ Rekomendasi Kalori Diet Harian
                    ‚úÖ Pembagian Makronutrien (Protein, Lemak, Karbo)
                    ‚úÖ Estimasi Turun per Minggu
                    ‚úÖ Estimasi Waktu Capai Target
                    ‚úÖ Laporan Detail 2 Halaman (PDF)
                    
                    ‚≠ê KENAPA HARUS BELI DI SINI?
                    ‚úîÔ∏è Perhitungan otomatis & sistematis (bukan asal hitung)
                    ‚úîÔ∏è Laporan rapi & profesional (siap pakai)
                    ‚úîÔ∏è Bisa pilih metode diet sesuai kebutuhan
                    ‚úîÔ∏è Lebih jelas & terarah dibanding diet tebak-tebakan
                    ‚úîÔ∏è Cocok untuk pemula maupun yang sudah paham makro
                    ‚úîÔ∏è Praktis ‚Äì tanpa aplikasi ribet
                    
                    ‚öôÔ∏è PILIH METODE DIET
                    üîπ Defisit Ringan ‚Äì lebih santai & stabil
                    üîπ Defisit Standar ‚Äì seimbang & realistis
                    üîπ Defisit Agresif ‚Äì lebih cepat, perlu konsistensi
                    
                    üéØ COCOK UNTUK:
                    ‚úîÔ∏è Pemula yang ingin diet terarah
                    ‚úîÔ∏è Program cutting
                    ‚úîÔ∏è Yang ingin tahu angka pasti kalori
                    ‚úîÔ∏è Yang ingin diet lebih realistis & terukur
                    
                    üì¶ FORMAT PRODUK
                    üì© Produk digital (PDF)
                    Bukan aplikasi / bukan barang fisik
                    Dikirim via chat setelah pembelian
                    
                    ‚ö†Ô∏è PENTING
                    Perhitungan bersifat estimasi dan tidak menggantikan konsultasi medis
                    `,
                },
                { 
                    id: 2, 
                    category: 'kapsul', 
                    name: "KEMOENIK SLIM 1", 
                    price: 100000,
                    active: true,
                    originalPrice: 150000,
                    discount: 33, 
                    flashSale: true,
                    // [GANTI] 5 GAMBAR PRODUK
                    images: [
                        "https://placehold.co/400x400/DCFCE7/166534?text=Slim1-1",  // [GANTI]
                        "https://placehold.co/400x400/DCFCE7/166534?text=Slim1-2",  // [GANTI]
                        "https://placehold.co/400x400/DCFCE7/166534?text=Slim1-3",  // [GANTI]
                        "https://placehold.co/400x400/DCFCE7/166534?text=Slim1-4",  // [GANTI]
                        "https://placehold.co/400x400/DCFCE7/166534?text=Slim1-5"   // [GANTI]
                    ], 
                    sold: 1892, 
                    rating: 4.8, 
                    desc: `
                    üåø PAKET SLIMMING + BONUS ANALISIS DIET PERSONAL

                    Program penurunan berat badan yang lebih terarah tidak hanya bergantung pada produk, tetapi juga pada pengaturan pola makan yang sesuai kebutuhan tubuh.

                    Melalui paket ini, Anda mendapatkan produk pilihan sekaligus akses ke sistem analisis diet personal.

                    üéÅ BONUS: CALFATLOSS ‚Äì Smart Nutrition Calculator

                    Setiap pembelian produk akan mendapatkan akses ke:

                    ‚úîÔ∏è Perhitungan BMR & TDEE
                    ‚úîÔ∏è Rekomendasi kalori harian
                    ‚úîÔ∏è Pembagian makronutrien (Protein, Lemak, Karbo)
                    ‚úîÔ∏è Estimasi durasi program
                    ‚úîÔ∏è Laporan PDF yang dapat diunduh & dicetak

                    üìå CARA MENDAPATKAN BONUS

                    1Ô∏è‚É£ Lakukan pembelian produk seperti biasa
                    2Ô∏è‚É£ Setelah pesanan diproses, Anda akan menerima link akses sistem
                    3Ô∏è‚É£ Isi data (usia, berat badan, tinggi badan, aktivitas, target)
                    4Ô∏è‚É£ Sistem otomatis menghasilkan laporan
                    5Ô∏è‚É£ Unduh & cetak PDF Anda sendiri

                    üéØ KEUNGGULAN SISTEM

                    ‚úîÔ∏è Otomatis & praktis
                    ‚úîÔ∏è Data dihitung sesuai input pribadi
                    ‚úîÔ∏è Bisa langsung diunduh
                    ‚úîÔ∏è Lebih privat & fleksibel

                    ‚ö†Ô∏è CATATAN

                    ‚Ä¢ Bonus diberikan untuk setiap pembelian produk
                    ‚Ä¢ Laporan bersifat estimasi
                    ‚Ä¢ Tidak menggantikan konsultasi medis
                    ‚Ä¢ Hasil tiap individu dapat berbeda
                    `,
                },
                { 
                    id: 3, 
                    category: 'kapsul', 
                    name: "KEMOENIK SLIM 2", 
                    price: 75000,
                    active: false,
                    originalPrice: 100000,
                    discount: 25, 
                    flashSale: false,
                    // [GANTI] 5 GAMBAR PRODUK
                    images: [
                        "https://placehold.co/400x400/FEF3C7/92400E?text=Slim2-1",  // [GANTI]
                        "https://placehold.co/400x400/FEF3C7/92400E?text=Slim2-2",  // [GANTI]
                        "https://placehold.co/400x400/FEF3C7/92400E?text=Slim2-3",  // [GANTI]
                        "https://placehold.co/400x400/FEF3C7/92400E?text=Slim2-4",  // [GANTI]
                        "https://placehold.co/400x400/FEF3C7/92400E?text=Slim2-5"   // [GANTI]
                    ], 
                    sold: 956, 
                    rating: 4.7, 
                    desc: `
                    üåø PAKET SLIMMING + BONUS ANALISIS DIET PERSONAL

                    Program penurunan berat badan yang lebih terarah tidak hanya bergantung pada produk, tetapi juga pada pengaturan pola makan yang sesuai kebutuhan tubuh.

                    Melalui paket ini, Anda mendapatkan produk pilihan sekaligus akses ke sistem analisis diet personal.

                    üéÅ BONUS: CALFATLOSS ‚Äì Smart Nutrition Calculator

                    Setiap pembelian produk akan mendapatkan akses ke:

                    ‚úîÔ∏è Perhitungan BMR & TDEE
                    ‚úîÔ∏è Rekomendasi kalori harian
                    ‚úîÔ∏è Pembagian makronutrien (Protein, Lemak, Karbo)
                    ‚úîÔ∏è Estimasi durasi program
                    ‚úîÔ∏è Laporan PDF yang dapat diunduh & dicetak

                    üìå CARA MENDAPATKAN BONUS

                    1Ô∏è‚É£ Lakukan pembelian produk seperti biasa
                    2Ô∏è‚É£ Setelah pesanan diproses, Anda akan menerima link akses sistem
                    3Ô∏è‚É£ Isi data (usia, berat badan, tinggi badan, aktivitas, target)
                    4Ô∏è‚É£ Sistem otomatis menghasilkan laporan
                    5Ô∏è‚É£ Unduh & cetak PDF Anda sendiri

                    üéØ KEUNGGULAN SISTEM

                    ‚úîÔ∏è Otomatis & praktis
                    ‚úîÔ∏è Data dihitung sesuai input pribadi
                    ‚úîÔ∏è Bisa langsung diunduh
                    ‚úîÔ∏è Lebih privat & fleksibel

                    ‚ö†Ô∏è CATATAN

                    ‚Ä¢ Bonus diberikan untuk setiap pembelian produk
                    ‚Ä¢ Laporan bersifat estimasi
                    ‚Ä¢ Tidak menggantikan konsultasi medis
                    ‚Ä¢ Hasil tiap individu dapat berbeda
                    `,
                },
                { 
                    id: 4, 
                    category: 'teh', 
                    name: "TEH SLIM 1", 
                    price: 45000,
                    active: false,
                    originalPrice: 60000,
                    discount: 25, 
                    flashSale: false,
                    // [GANTI] 5 GAMBAR PRODUK
                    images: [
                        "https://placehold.co/400x400/D1FAE5/065F46?text=Teh1-1",  // [GANTI]
                        "https://placehold.co/400x400/D1FAE5/065F46?text=Teh1-2",  // [GANTI]
                        "https://placehold.co/400x400/D1FAE5/065F46?text=Teh1-3",  // [GANTI]
                        "https://placehold.co/400x400/D1FAE5/065F46?text=Teh1-4",  // [GANTI]
                        "https://placehold.co/400x400/D1FAE5/065F46?text=Teh1-5"   // [GANTI]
                    ], 
                    sold: 3421, 
                    rating: 4.9, 
                    desc: `
                    üåø PAKET SLIMMING + BONUS ANALISIS DIET PERSONAL

                    Program penurunan berat badan yang lebih terarah tidak hanya bergantung pada produk, tetapi juga pada pengaturan pola makan yang sesuai kebutuhan tubuh.

                    Melalui paket ini, Anda mendapatkan produk pilihan sekaligus akses ke sistem analisis diet personal.

                    üéÅ BONUS: CALFATLOSS ‚Äì Smart Nutrition Calculator

                    Setiap pembelian produk akan mendapatkan akses ke:

                    ‚úîÔ∏è Perhitungan BMR & TDEE
                    ‚úîÔ∏è Rekomendasi kalori harian
                    ‚úîÔ∏è Pembagian makronutrien (Protein, Lemak, Karbo)
                    ‚úîÔ∏è Estimasi durasi program
                    ‚úîÔ∏è Laporan PDF yang dapat diunduh & dicetak

                    üìå CARA MENDAPATKAN BONUS

                    1Ô∏è‚É£ Lakukan pembelian produk seperti biasa
                    2Ô∏è‚É£ Setelah pesanan diproses, Anda akan menerima link akses sistem
                    3Ô∏è‚É£ Isi data (usia, berat badan, tinggi badan, aktivitas, target)
                    4Ô∏è‚É£ Sistem otomatis menghasilkan laporan
                    5Ô∏è‚É£ Unduh & cetak PDF Anda sendiri

                    üéØ KEUNGGULAN SISTEM

                    ‚úîÔ∏è Otomatis & praktis
                    ‚úîÔ∏è Data dihitung sesuai input pribadi
                    ‚úîÔ∏è Bisa langsung diunduh
                    ‚úîÔ∏è Lebih privat & fleksibel

                    ‚ö†Ô∏è CATATAN

                    ‚Ä¢ Bonus diberikan untuk setiap pembelian produk
                    ‚Ä¢ Laporan bersifat estimasi
                    ‚Ä¢ Tidak menggantikan konsultasi medis
                    ‚Ä¢ Hasil tiap individu dapat berbeda
                    `,
                },
                { 
                    id: 5, 
                    category: 'teh', 
                    name: "TEH SLIM 2", 
                    price: 55000,
                    active: false,
                    originalPrice: 75000,
                    discount: 27, 
                    flashSale: false,
                    // [GANTI] 5 GAMBAR PRODUK
                    images: [
                        "https://placehold.co/400x400/ECFDF5/047857?text=Teh2-1",  // [GANTI]
                        "https://placehold.co/400x400/ECFDF5/047857?text=Teh2-2",  // [GANTI]
                        "https://placehold.co/400x400/ECFDF5/047857?text=Teh2-3",  // [GANTI]
                        "https://placehold.co/400x400/ECFDF5/047857?text=Teh2-4",  // [GANTI]
                        "https://placehold.co/400x400/ECFDF5/047857?text=Teh2-5"   // [GANTI]
                    ], 
                    sold: 2876, 
                    rating: 4.8, 
                    desc: `
                    üåø PAKET SLIMMING + BONUS ANALISIS DIET PERSONAL

                    Program penurunan berat badan yang lebih terarah tidak hanya bergantung pada produk, tetapi juga pada pengaturan pola makan yang sesuai kebutuhan tubuh.

                    Melalui paket ini, Anda mendapatkan produk pilihan sekaligus akses ke sistem analisis diet personal.

                    üéÅ BONUS: CALFATLOSS ‚Äì Smart Nutrition Calculator

                    Setiap pembelian produk akan mendapatkan akses ke:

                    ‚úîÔ∏è Perhitungan BMR & TDEE
                    ‚úîÔ∏è Rekomendasi kalori harian
                    ‚úîÔ∏è Pembagian makronutrien (Protein, Lemak, Karbo)
                    ‚úîÔ∏è Estimasi durasi program
                    ‚úîÔ∏è Laporan PDF yang dapat diunduh & dicetak

                    üìå CARA MENDAPATKAN BONUS

                    1Ô∏è‚É£ Lakukan pembelian produk seperti biasa
                    2Ô∏è‚É£ Setelah pesanan diproses, Anda akan menerima link akses sistem
                    3Ô∏è‚É£ Isi data (usia, berat badan, tinggi badan, aktivitas, target)
                    4Ô∏è‚É£ Sistem otomatis menghasilkan laporan
                    5Ô∏è‚É£ Unduh & cetak PDF Anda sendiri

                    üéØ KEUNGGULAN SISTEM

                    ‚úîÔ∏è Otomatis & praktis
                    ‚úîÔ∏è Data dihitung sesuai input pribadi
                    ‚úîÔ∏è Bisa langsung diunduh
                    ‚úîÔ∏è Lebih privat & fleksibel

                    ‚ö†Ô∏è CATATAN

                    ‚Ä¢ Bonus diberikan untuk setiap pembelian produk
                    ‚Ä¢ Laporan bersifat estimasi
                    ‚Ä¢ Tidak menggantikan konsultasi medis
                    ‚Ä¢ Hasil tiap individu dapat berbeda
                    `, 
                },
                { 
                    id: 6, 
                    category: 'lainnya', 
                    name: "SERUM WAJAH GLOW", 
                    price: 85000,
                    active: false,
                    originalPrice: 120000,
                    discount: 29, 
                    flashSale: false,
                    // [GANTI] 5 GAMBAR PRODUK
                    images: [
                        "https://placehold.co/400x400/FDF4FF/86198F?text=Serum-1",  // [GANTI]
                        "https://placehold.co/400x400/FDF4FF/86198F?text=Serum-2",  // [GANTI]
                        "https://placehold.co/400x400/FDF4FF/86198F?text=Serum-3",  // [GANTI]
                        "https://placehold.co/400x400/FDF4FF/86198F?text=Serum-4",  // [GANTI]
                        "https://placehold.co/400x400/FDF4FF/86198F?text=Serum-5"   // [GANTI]
                    ], 
                    sold: 1234, 
                    rating: 4.6, 
                    desc: `
                    üåø PAKET SLIMMING + BONUS ANALISIS DIET PERSONAL

                    Program penurunan berat badan yang lebih terarah tidak hanya bergantung pada produk, tetapi juga pada pengaturan pola makan yang sesuai kebutuhan tubuh.

                    Melalui paket ini, Anda mendapatkan produk pilihan sekaligus akses ke sistem analisis diet personal.

                    üéÅ BONUS: CALFATLOSS ‚Äì Smart Nutrition Calculator

                    Setiap pembelian produk akan mendapatkan akses ke:

                    ‚úîÔ∏è Perhitungan BMR & TDEE
                    ‚úîÔ∏è Rekomendasi kalori harian
                    ‚úîÔ∏è Pembagian makronutrien (Protein, Lemak, Karbo)
                    ‚úîÔ∏è Estimasi durasi program
                    ‚úîÔ∏è Laporan PDF yang dapat diunduh & dicetak

                    üìå CARA MENDAPATKAN BONUS

                    1Ô∏è‚É£ Lakukan pembelian produk seperti biasa
                    2Ô∏è‚É£ Setelah pesanan diproses, Anda akan menerima link akses sistem
                    3Ô∏è‚É£ Isi data (usia, berat badan, tinggi badan, aktivitas, target)
                    4Ô∏è‚É£ Sistem otomatis menghasilkan laporan
                    5Ô∏è‚É£ Unduh & cetak PDF Anda sendiri

                    üéØ KEUNGGULAN SISTEM

                    ‚úîÔ∏è Otomatis & praktis
                    ‚úîÔ∏è Data dihitung sesuai input pribadi
                    ‚úîÔ∏è Bisa langsung diunduh
                    ‚úîÔ∏è Lebih privat & fleksibel

                    ‚ö†Ô∏è CATATAN

                    ‚Ä¢ Bonus diberikan untuk setiap pembelian produk
                    ‚Ä¢ Laporan bersifat estimasi
                    ‚Ä¢ Tidak menggantikan konsultasi medis
                    ‚Ä¢ Hasil tiap individu dapat berbeda
                    `, 
                },
                { 
                    id: 7, 
                    category: 'kapsul', 
                    name: "VITAMIN C 1000MG", 
                    price: 35000,
                    active: false,
                    originalPrice: 50000,
                    discount: 30, 
                    flashSale: true,
                    // [GANTI] 5 GAMBAR PRODUK
                    images: [
                        "https://placehold.co/400x400/FEE2E2/991B1B?text=VitC-1",  // [GANTI]
                        "https://placehold.co/400x400/FEE2E2/991B1B?text=VitC-2",  // [GANTI]
                        "https://placehold.co/400x400/FEE2E2/991B1B?text=VitC-3",  // [GANTI]
                        "https://placehold.co/400x400/FEE2E2/991B1B?text=VitC-4",  // [GANTI]
                        "https://placehold.co/400x400/FEE2E2/991B1B?text=VitC-5"   // [GANTI]
                    ], 
                    sold: 5678, 
                    rating: 4.9, 
                    desc: `
                    üåø PAKET SLIMMING + BONUS ANALISIS DIET PERSONAL

                    Program penurunan berat badan yang lebih terarah tidak hanya bergantung pada produk, tetapi juga pada pengaturan pola makan yang sesuai kebutuhan tubuh.

                    Melalui paket ini, Anda mendapatkan produk pilihan sekaligus akses ke sistem analisis diet personal.

                    üéÅ BONUS: CALFATLOSS ‚Äì Smart Nutrition Calculator

                    Setiap pembelian produk akan mendapatkan akses ke:

                    ‚úîÔ∏è Perhitungan BMR & TDEE
                    ‚úîÔ∏è Rekomendasi kalori harian
                    ‚úîÔ∏è Pembagian makronutrien (Protein, Lemak, Karbo)
                    ‚úîÔ∏è Estimasi durasi program
                    ‚úîÔ∏è Laporan PDF yang dapat diunduh & dicetak

                    üìå CARA MENDAPATKAN BONUS

                    1Ô∏è‚É£ Lakukan pembelian produk seperti biasa
                    2Ô∏è‚É£ Setelah pesanan diproses, Anda akan menerima link akses sistem
                    3Ô∏è‚É£ Isi data (usia, berat badan, tinggi badan, aktivitas, target)
                    4Ô∏è‚É£ Sistem otomatis menghasilkan laporan
                    5Ô∏è‚É£ Unduh & cetak PDF Anda sendiri

                    üéØ KEUNGGULAN SISTEM

                    ‚úîÔ∏è Otomatis & praktis
                    ‚úîÔ∏è Data dihitung sesuai input pribadi
                    ‚úîÔ∏è Bisa langsung diunduh
                    ‚úîÔ∏è Lebih privat & fleksibel

                    ‚ö†Ô∏è CATATAN

                    ‚Ä¢ Bonus diberikan untuk setiap pembelian produk
                    ‚Ä¢ Laporan bersifat estimasi
                    ‚Ä¢ Tidak menggantikan konsultasi medis
                    ‚Ä¢ Hasil tiap individu dapat berbeda
                    `, 
                },
                { 
                    id: 8, 
                    category: 'lainnya', 
                    name: "MINYAK KELAPA MURNI", 
                    price: 65000,
                    active: false,
                    originalPrice: 80000,
                    discount: 19, 
                    flashSale: false,
                    // [GANTI] 5 GAMBAR PRODUK
                    images: [
                        "https://placehold.co/400x400/FEF3C7/B45309?text=VCO-1",  // [GANTI]
                        "https://placehold.co/400x400/FEF3C7/B45309?text=VCO-2",  // [GANTI]
                        "https://placehold.co/400x400/FEF3C7/B45309?text=VCO-3",  // [GANTI]
                        "https://placehold.co/400x400/FEF3C7/B45309?text=VCO-4",  // [GANTI]
                        "https://placehold.co/400x400/FEF3C7/B45309?text=VCO-5"   // [GANTI]
                    ], 
                    sold: 892, 
                    rating: 4.7, 
                    desc: `
                    üåø PAKET SLIMMING + BONUS ANALISIS DIET PERSONAL

                    Program penurunan berat badan yang lebih terarah tidak hanya bergantung pada produk, tetapi juga pada pengaturan pola makan yang sesuai kebutuhan tubuh.

                    Melalui paket ini, Anda mendapatkan produk pilihan sekaligus akses ke sistem analisis diet personal.

                    üéÅ BONUS: CALFATLOSS ‚Äì Smart Nutrition Calculator

                    Setiap pembelian produk akan mendapatkan akses ke:

                    ‚úîÔ∏è Perhitungan BMR & TDEE
                    ‚úîÔ∏è Rekomendasi kalori harian
                    ‚úîÔ∏è Pembagian makronutrien (Protein, Lemak, Karbo)
                    ‚úîÔ∏è Estimasi durasi program
                    ‚úîÔ∏è Laporan PDF yang dapat diunduh & dicetak

                    üìå CARA MENDAPATKAN BONUS

                    1Ô∏è‚É£ Lakukan pembelian produk seperti biasa
                    2Ô∏è‚É£ Setelah pesanan diproses, Anda akan menerima link akses sistem
                    3Ô∏è‚É£ Isi data (usia, berat badan, tinggi badan, aktivitas, target)
                    4Ô∏è‚É£ Sistem otomatis menghasilkan laporan
                    5Ô∏è‚É£ Unduh & cetak PDF Anda sendiri

                    üéØ KEUNGGULAN SISTEM

                    ‚úîÔ∏è Otomatis & praktis
                    ‚úîÔ∏è Data dihitung sesuai input pribadi
                    ‚úîÔ∏è Bisa langsung diunduh
                    ‚úîÔ∏è Lebih privat & fleksibel

                    ‚ö†Ô∏è CATATAN

                    ‚Ä¢ Bonus diberikan untuk setiap pembelian produk
                    ‚Ä¢ Laporan bersifat estimasi
                    ‚Ä¢ Tidak menggantikan konsultasi medis
                    ‚Ä¢ Hasil tiap individu dapat berbeda
                    `, 
                }
            ]
        };

        // ========== STATE VARIABLES ==========
        let cart = [];
        let wishlist = [];
        let appliedCoupon = null;
        let currentSlide = 0;
        let activeCategory = 'all';
        let lastCheckoutData = { customer: {}, method: 'transfer', coupon: null };
        let currentInvoice = {};
        let slideInterval = null;
        let testimoniInterval = null;

        // ========== GALLERY VARIABLES ==========
        let currentGallerySlide = 0;
        let totalGallerySlides = 0;

        // ========== INITIALIZATION ==========
        document.addEventListener('DOMContentLoaded', () => {
            loadData();
            renderCategories();
            renderProducts();
            renderSliders();
            renderTestimoniSlider();
            renderPromoProducts();
            
            document.getElementById('wa-btn-header').href = `https://wa.me/${CONFIG.whatsappNumber}`;
            document.getElementById('store-name').innerText = CONFIG.storeName;
        });

        // ========== UTILITY FUNCTIONS ==========
        function toggleBodyScroll(lock) {
            document.body.style.overflow = lock ? 'hidden' : '';
        }

        function loadData() {
            try { cart = JSON.parse(localStorage.getItem('cart')) || []; } catch (e) { cart = []; }
            try { wishlist = JSON.parse(localStorage.getItem('wish')) || []; } catch (e) { wishlist = []; }
            updateStickyBar();
            updateWishlistUI();
        }

        function saveData() {
            localStorage.setItem('cart', JSON.stringify(cart));
            localStorage.setItem('wish', JSON.stringify(wishlist));
        }

        function formatPrice(price) {
            return `Rp ${price.toLocaleString('id-ID')}`;
        }

        function generateStars(rating) {
            let stars = '';
            const fullStars = Math.floor(rating);
            const hasHalf = rating % 1 >= 0.5;
            
            for (let i = 0; i < fullStars; i++) {
                stars += '<svg class="w-3 h-3 fill-current" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>';
            }
            if (hasHalf) {
                stars += '<svg class="w-3 h-3 fill-current opacity-50" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>';
            }
            return stars;
        }

        function formatSold(sold) {
            if (sold >= 1000) {
                return (sold / 1000).toFixed(1).replace('.0', '') + 'rb+';
            }
            return sold + '+';
        }

        // ========== SLIDER HERO FUNCTIONS ==========
        function renderSliders() {
            const sliderContainer = document.getElementById('hero-slider');
            const dotsContainer = document.getElementById('slider-dots');
            
            sliderContainer.innerHTML = CONFIG.sliders.map((img, i) => `
                <div class="slide-item">
                    <img src="${img}" alt="Banner ${i + 1}" loading="lazy">
                </div>
            `).join('');
            
            dotsContainer.innerHTML = CONFIG.sliders.map((_, i) => `
                <button onclick="goToSlide(${i})" class="dot ${i === 0 ? 'active' : ''}"></button>
            `).join('');
            
            startSlider();
        }

        function startSlider() {
            if (slideInterval) clearInterval(slideInterval);
            slideInterval = setInterval(() => {
                currentSlide = (currentSlide + 1) % CONFIG.sliders.length;
                updateSlider();
            }, 4000);
        }

        function updateSlider() {
            const slider = document.getElementById('hero-slider');
            slider.style.transform = `translateX(-${currentSlide * 100}%)`;
            
            document.querySelectorAll('#slider-dots .dot').forEach((dot, i) => {
                dot.classList.toggle('active', i === currentSlide);
            });
        }

        function goToSlide(index) {
            currentSlide = index;
            updateSlider();
            startSlider();
        }

        // ========== SLIDER TESTIMONI FUNCTIONS ==========
        function renderTestimoniSlider() {
            const container = document.getElementById('category-slider');
            const dotsContainer = document.getElementById('category-slider-dots');

            container.innerHTML = CONFIG.testimoniSliders.map((img, i) => `
                <div class="slide-item">
                    <img src="${img}" loading="lazy" style="width: 100%; height: 200px; object-fit: cover; border-radius: 16px;">
                </div>
            `).join('');

            dotsContainer.innerHTML = CONFIG.testimoniSliders.map((_, i) => `
                <div class="dot ${i === 0 ? 'active' : ''}" onclick="goToTestimoniSlide(${i})"></div>
            `).join('');

            startTestimoniSlider();
        }

        function startTestimoniSlider() {
            if (testimoniInterval) clearInterval(testimoniInterval);
            testimoniInterval = setInterval(() => {
                testimoniIndex = (testimoniIndex + 1) % CONFIG.testimoniSliders.length;
                updateTestimoniSlider();
            }, 4000);
        }

        let testimoniIndex = 0;

        function updateTestimoniSlider() {
            const slider = document.getElementById('category-slider');
            slider.style.transform = `translateX(-${testimoniIndex * 100}%)`;

            document.querySelectorAll('#category-slider-dots .dot').forEach((dot, i) => {
                dot.classList.toggle('active', i === testimoniIndex);
            });
        }

        function goToTestimoniSlide(index) {
            testimoniIndex = index;
            updateTestimoniSlider();
        }

        // ========== PROMO PRODUCTS RENDER ==========
        function renderPromoProducts() {
            const container = document.getElementById('promo-container');
            if (!container) return;

            // Filter produk yang active: true AND flashSale: true
            const promoProducts = CONFIG.products
                .filter(p => p.active === true && p.flashSale === true)
                .slice(0, 6); // Maksimal 6 produk promo

            if (promoProducts.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-400 py-4 col-span-2">Tidak ada promo saat ini</p>';
                return;
            }

            container.innerHTML = promoProducts.map(p => {
                const finalPrice = p.price - Math.floor(p.price * (p.discount || 0) / 100);
                
                return `
                <div class="promo-card" onclick="openDetail(${p.id})">
                    <img src="${p.images?.[0] || 'https://placehold.co/400x400/F3F4F6/9CA3AF?text=No+Image'}" alt="${p.name}">
                    <div class="promo-content">
                        <div class="promo-title">${p.name}</div>
                        <div>
                            <span class="promo-price">${formatPrice(finalPrice)}</span>
                            ${p.originalPrice ? `<span class="promo-old-price">${formatPrice(p.originalPrice)}</span>` : ''}
                        </div>
                    </div>
                </div>
            `}).join('');
        }

        // ========== CATEGORY FUNCTIONS ==========
        function renderCategories() {
            const container = document.getElementById('category-list');
            container.innerHTML = CONFIG.categories.map(c => `
               <div onclick="filterCategory('${c.id}')" 
                    class="category-text ${c.id === activeCategory ? 'active' : ''}">
                   ${c.name}
               </div>
            `).join('');
        }

        function filterCategory(id) {
            activeCategory = id;
            renderCategories();
            renderProducts();
            document.getElementById('product-section').scrollIntoView({ behavior: 'smooth' });
        }

        // ========== PRODUCT RENDERING ==========
        function renderProducts() {
            const container = document.getElementById('product-grid');
            
            // Filter produk yang active: true
            let data = CONFIG.products.filter(p => p.active === true);
            
            // Filter berdasarkan kategori jika bukan 'all'
            if (activeCategory !== 'all') {
                data = data.filter(p => p.category === activeCategory);
            }
            
            container.innerHTML = data.map(p => {
                const imgSrc = p.images?.[0] || 'https://placehold.co/400x400/F3F4F6/9CA3AF?text=No+Image';
                const isWished = wishlist.some(w => w.id === p.id);
                const finalPrice = p.price - Math.floor(p.price * (p.discount || 0) / 100);
                
                return `
                <div class="product-card" onclick="openDetail(${p.id})">
                    <div class="product-img-wrapper">
                        <img src="${imgSrc}" class="product-img" alt="${p.name}" loading="lazy">
                        
                        ${p.flashSale ? '<span class="flash-sale-badge">Flash Sale</span>' : ''}
                        ${p.discount > 0 ? `<span class="discount-badge">${p.discount}% OFF</span>` : ''}
                        
                        <button onclick="event.stopPropagation(); toggleWishlist(${p.id})" class="wishlist-btn-card ${isWished ? 'active' : ''}" aria-label="Toggle Wishlist">
                            <svg fill="${isWished ? '#ef4444' : 'none'}" stroke="${isWished ? '#ef4444' : '#9ca3af'}" stroke-width="2" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                            </svg>
                        </button>
                    </div>
                    <div class="product-info">
                        <h3 class="product-title">${p.name}</h3>
                        
                        <div class="product-meta">
                            <span class="rating-stars">
                                ${generateStars(p.rating)}
                                <span class="ml-1 text-gray-600">${p.rating}</span>
                            </span>
                            <span class="sold-count">| ${formatSold(p.sold)} terjual</span>
                        </div>
                        
                        <div class="product-price">${formatPrice(finalPrice)}</div>
                        ${p.originalPrice ? `<div class="product-price-original">${formatPrice(p.originalPrice)}</div>` : '<div style="height: 16px;"></div>'}
                        
                        <button onclick="event.stopPropagation(); addCart(${p.id})" class="product-btn">+ Keranjang</button>
                    </div>
                </div>`;
            }).join('');
        }

        // ========== MODAL FUNCTIONS ==========
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.add('active');
            toggleBodyScroll(true);
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.remove('active');
            toggleBodyScroll(false);
        }

        // ========== GALLERY FUNCTIONS ==========
        function initGallery(total) {
            currentGallerySlide = 0;
            totalGallerySlides = total;
        }

        function updateGallerySlider() {
            const slider = document.getElementById('gallery-slider');
            if (slider) {
                slider.style.transform = `translateX(-${currentGallerySlide * 100}%)`;
                
                document.querySelectorAll('.gallery-dot').forEach((dot, idx) => {
                    dot.classList.toggle('active', idx === currentGallerySlide);
                });
            }
        }

        function nextGallerySlide() {
            if (currentGallerySlide < totalGallerySlides - 1) {
                currentGallerySlide++;
                updateGallerySlider();
            }
        }

        function prevGallerySlide() {
            if (currentGallerySlide > 0) {
                currentGallerySlide--;
                updateGallerySlider();
            }
        }

        function goToGallerySlide(index) {
            currentGallerySlide = index;
            updateGallerySlider();
        }

        // ========== DETAIL MODAL WITH GALLERY ==========
        function openDetail(id) {
            let p = CONFIG.products.find(x => x.id == id);
            if(!p) return;
            
            const finalPrice = p.price - Math.floor(p.price * (p.discount || 0) / 100);
            const hasMultipleImages = p.images && p.images.length > 1;
            
            const galleryHtml = hasMultipleImages ? `
                <div id="product-gallery">
                    <div id="gallery-slider">
                        ${p.images.map((img, idx) => `
                            <img src="${img}" alt="${p.name} - ${idx + 1}">
                        `).join('')}
                    </div>
                    
                    <div style="position: absolute; bottom: 15px; left: 50%; transform: translateX(-50%); display: flex; gap: 6px; z-index: 10;">
                        ${p.images.map((_, idx) => `
                            <button onclick="goToGallerySlide(${idx})" 
                                class="gallery-dot ${idx === 0 ? 'active' : ''}" data-index="${idx}"></button>
                        `).join('')}
                    </div>
                    
                    <button onclick="prevGallerySlide()" class="gallery-nav gallery-prev">
                        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
                    </button>
                    <button onclick="nextGallerySlide()" class="gallery-nav gallery-next">
                        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
                    </button>
                </div>
            ` : `
                <div class="relative">
                    <img src="${p.images?.[0] || 'https://placehold.co/400'}" class="w-full aspect-square object-cover" alt="${p.name}">
                </div>
            `;
            
            const content = `
            <div class="relative bg-gray-100">
                ${galleryHtml}
                
                <button onclick="closeDetail()" class="absolute top-3 right-3 bg-white p-2 rounded-full shadow-lg hover:bg-gray-100 transition z-20">
                    <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
                </button>
                ${p.flashSale ? '<span class="flash-sale-badge">Flash Sale</span>' : ''}
            </div>
            <div class="p-5 bg-white rounded-t-3xl -mt-6 relative">
                <h2 class="text-lg font-bold text-gray-800 mb-2">${p.name}</h2>
                
                <div class="flex items-center gap-3 mb-3">
                    <span class="rating-stars text-sm">
                        ${generateStars(p.rating || 5)}
                        <span class="ml-1 text-gray-700 font-semibold">${p.rating || 5}</span>
                    </span>
                    <span class="text-gray-400">|</span>
                    <span class="text-sm text-gray-500">${formatSold(p.sold || 100)} terjual</span>
                </div>
                
                <div class="flex items-baseline gap-2 mb-4">
                    <span class="text-2xl font-bold" style="color: var(--primary-dark);">${formatPrice(finalPrice || p.price)}</span>
                    ${p.originalPrice ? `<span class="text-sm text-gray-400 line-through">${formatPrice(p.originalPrice)}</span>` : ''}
                    ${p.discount > 0 ? `<span class="text-xs font-bold px-2 py-1 rounded-full" style="background: #FEF3C7; color: #B45309;">${p.discount}% OFF</span>` : ''}
                </div>
                
                <div class="border-t border-b border-gray-100 my-4 py-4">
                    <h4 class="font-semibold mb-2 text-sm text-gray-700">Deskripsi Produk</h4>
                    <p class="text-sm text-gray-600 leading-relaxed">${p.desc || 'Produk berkualitas dari Kemoenik Official Store.'}</p>
                </div>
                
                <div class="flex gap-3 mt-4">
                    <button onclick="addCart(${p.id}); closeDetail();" class="flex-1 bg-white border-2 font-semibold py-3 rounded-xl transition-colors" style="border-color: var(--primary); color: var(--primary-dark);">Tambah</button>
                    <button onclick="addCart(${p.id}); closeDetail(); openCart();" class="flex-1 btn-primary py-3">Beli Sekarang</button>
                </div>
            </div>`;
            
            document.getElementById('detail-content').innerHTML = content;
            openModal('detail-modal');
            
            if (hasMultipleImages) {
                initGallery(p.images.length);
            }
        }

        function closeDetail() {
            closeModal('detail-modal');
        }

        // Touch swipe untuk gallery
        let touchStartX = 0;
        let touchEndX = 0;

        document.addEventListener('touchstart', e => {
            if (e.target.closest('#product-gallery')) {
                touchStartX = e.changedTouches[0].screenX;
            }
        }, false);

        document.addEventListener('touchend', e => {
            if (e.target.closest('#product-gallery')) {
                touchEndX = e.changedTouches[0].screenX;
                handleGallerySwipe();
            }
        }, false);

        function handleGallerySwipe() {
            if (touchEndX < touchStartX - 50) nextGallerySlide();
            if (touchEndX > touchStartX + 50) prevGallerySlide();
        }

        // ========== WISHLIST FUNCTIONS ==========
        function toggleWishlist(id) {
            const p = CONFIG.products.find(x => x.id === id);
            if (!p) return;
            
            const exist = wishlist.find(w => w.id === id);
            if (exist) {
                wishlist = wishlist.filter(w => w.id !== id);
            } else {
                wishlist.push({ id: p.id, name: p.name, images: p.images });
            }
            
            saveData();
            updateWishlistUI();
            renderProducts();
        }

        function updateWishlistUI() {
            const el = document.getElementById('wish-count-head');
            const count = wishlist.length;
            
            if (count > 0) {
                el.innerText = count;
                el.classList.remove('hidden');
                el.classList.add('flex');
            } else {
                el.classList.add('hidden');
            }
        }

        function openWishlist() {
            let content = `
                <div class="flex justify-between items-center mb-4">
                    <h3 class="font-bold text-lg">Wishlist Saya</h3>
                    <button onclick="closeWishlist()" class="text-gray-400 p-2 hover:text-gray-600">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
                    </button>
                </div>`;
            
            if (wishlist.length === 0) {
                content += '<p class="text-center text-gray-400 py-12">Wishlist masih kosong</p>';
            } else {
                content += `<div class="space-y-3">` + wishlist.map(w => `
                    <div class="flex gap-3 items-center p-2 hover:bg-gray-50 rounded-lg cursor-pointer" onclick="closeWishlist(); openDetail(${w.id});">
                        <img src="${w.images?.[0] || 'https://placehold.co/100'}" class="w-16 h-16 rounded-xl object-cover">
                        <div class="flex-1">
                            <h4 class="font-semibold text-sm text-gray-800">${w.name}</h4>
                            <p class="text-[10px] text-emerald-500 mt-1 font-medium">Klik untuk lihat detail</p>
                        </div>
                        <button onclick="event.stopPropagation(); toggleWishlist(${w.id}); openWishlist();" class="text-gray-400 hover:text-red-500 p-2">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg>
                        </button>
                    </div>
                `).join('') + `</div>`;
            }
            
            document.getElementById('wishlist-content').innerHTML = content;
            openModal('wishlist-modal');
        }

        function closeWishlist() {
            closeModal('wishlist-modal');
        }

        // ========== CART FUNCTIONS ==========
        function addCart(id) {
            const p = CONFIG.products.find(x => x.id === id);
            if (!p) return;
            
            const exist = cart.find(i => i.id === id);
            const finalPrice = p.price - Math.floor(p.price * (p.discount || 0) / 100);
            
            if (exist) {
                exist.qty++;
            } else {
                cart.push({
                    id: p.id,
                    name: p.name,
                    price: finalPrice,
                    images: p.images,
                    qty: 1
                });
            }
            
            saveData();
            updateStickyBar();
        }

        function updateStickyBar() {
            const count = cart.reduce((s, i) => s + i.qty, 0);
            const total = cart.reduce((s, i) => s + (i.price * i.qty), 0);
            
            document.getElementById('sticky-count').innerText = count;
            document.getElementById('sticky-items').innerText = count;
            document.getElementById('sticky-total').innerText = formatPrice(total);
            document.getElementById('sticky-bar').style.display = count > 0 ? 'block' : 'none';
        }

        function openCart() {
            renderCartModal();
            openModal('cart-modal');
        }

        function closeCart() {
            closeModal('cart-modal');
        }

        function renderCartModal() {
            const content = document.getElementById('cart-content');
            content.innerHTML = `
                <div class="flex justify-between items-center mb-4">
                    <h3 class="font-bold text-lg">Keranjang Belanja</h3>
                    <button onclick="closeCart()" class="text-gray-400 p-2">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
                    </button>
                </div>
                
                <div id="cart-list" class="max-h-48 overflow-y-auto border-b pb-4 mb-4" style="-webkit-overflow-scrolling: touch;"></div>
                
                <div class="mb-4">
                    <div class="flex gap-2">
                        <input type="text" id="coupon-input" class="input-style mb-0 text-sm flex-1" placeholder="Kode Kupon" value="${appliedCoupon ? appliedCoupon.code : ''}">
                        <button onclick="applyCoupon()" class="text-white px-4 rounded-xl text-xs font-bold" style="background: #1F2937;">Pakai</button>
                    </div>
                    <p id="coupon-msg" class="text-[11px] mt-1 hidden"></p>
                </div>
                
                <div class="mb-4 bg-gray-50 p-3 rounded-xl text-xs text-gray-600">
                    <p class="font-semibold text-gray-700 mb-1">Ongkos Kirim:</p>
                    <p class="text-gray-500">Akan dikonfirmasi via WhatsApp.</p>
                </div>
                
                <div class="mb-4">
                    <label class="text-xs text-gray-500 font-medium">Metode Pembayaran</label>
                    <select id="payment-method" class="input-style mb-0 text-sm mt-1" onchange="handlePaymentChange()">
                        <option value="transfer" ${lastCheckoutData.method === 'transfer' ? 'selected' : ''}>Transfer Produk + Ongkir</option>
                        <option value="cod_ongkir" ${lastCheckoutData.method === 'cod_ongkir' ? 'selected' : ''}>COD Ongkir Saja</option>
                        <option value="cod_full" ${lastCheckoutData.method === 'cod_full' ? 'selected' : ''}>COD Full (Bayar Ditempat)</option>
                    </select>
                    <p id="payment-note" class="text-[10px] text-gray-400 mt-1 hidden"></p>
                </div>

                <div id="transfer-method-container" class="mb-4">
                    <label class="text-xs text-gray-500 font-medium">Transfer Melalui</label>
                    <select id="transfer-bank" class="input-style text-sm mt-1">
                        <option value="BRI">Bank BRI</option>
                        <option value="DANA">DANA</option>
                        <option value="SeaBank">SeaBank</option>
                    </select>
                </div>

                <div class="bg-emerald-50 p-4 rounded-xl mb-4 text-sm">
                    <div class="flex justify-between mb-1"><span class="text-gray-600">Subtotal</span><span id="sum-subtotal">${formatPrice(0)}</span></div>
                    <div class="flex justify-between mb-1 text-red-500"><span>Diskon Ongkir</span><span id="sum-disc">- ${formatPrice(0)}</span></div>
                    <div class="border-t mt-2 pt-2 flex justify-between font-bold text-base">
                        <span>Total</span>
                        <span id="sum-total" style="color: var(--primary-dark);">${formatPrice(0)}</span>
                    </div>
                </div>
                
                <button onclick="proceedToCheckout()" class="btn-primary">Checkout Sekarang</button>`;
            
            renderCartItems();
            updateCartSummary();
            handlePaymentChange();
        }

        function handlePaymentChange() {
            const method = document.getElementById('payment-method').value;
            const transferBox = document.getElementById('transfer-method-container');
            const note = document.getElementById('payment-note');
            
            if (method === 'cod_full') {
                transferBox.classList.add('hidden');
                note.innerText = "COD Full tidak mendapat potongan ongkir.";
                note.classList.remove('hidden');
            } else {
                transferBox.classList.remove('hidden');
                note.classList.add('hidden');
            }
            lastCheckoutData.method = method;
            updateCartSummary();
        }

        function renderCartItems() {
            const el = document.getElementById('cart-list');
            
            if (cart.length === 0) {
                el.innerHTML = '<p class="text-center text-gray-400 py-8 text-sm">Keranjang kosong</p>';
                return;
            }
            
            el.innerHTML = cart.map(i => `
                <div class="flex gap-3 items-center mb-3 pb-3 border-b border-gray-100">
                    <img src="${i.images?.[0] || 'https://placehold.co/100'}" class="w-14 h-14 rounded-xl object-cover">
                    <div class="flex-1">
                        <h4 class="font-semibold text-sm text-gray-800">${i.name}</h4>
                        <div class="flex items-center gap-2 mt-1">
                            <button onclick="updateCartQty(${i.id}, -1)" class="w-6 h-6 bg-gray-100 rounded-lg text-sm font-bold hover:bg-gray-200 transition">-</button>
                            <span class="text-sm font-bold">${i.qty}</span>
                            <button onclick="updateCartQty(${i.id}, 1)" class="w-6 h-6 bg-gray-100 rounded-lg text-sm font-bold hover:bg-gray-200 transition">+</button>
                        </div>
                    </div>
                    <span class="text-sm font-bold" style="color: var(--primary-dark);">${formatPrice(i.price * i.qty)}</span>
                </div>
            `).join('');
        }

        function updateCartQty(id, delta) {
            const item = cart.find(x => x.id === id);
            if (item) {
                item.qty += delta;
                if (item.qty < 1) {
                    cart = cart.filter(x => x.id !== id);
                }
                saveData();
                renderCartModal();
                updateStickyBar();
            }
        }

        function updateCartSummary() {
            const subtotal = cart.reduce((s, i) => s + (i.price * i.qty), 0);
            const method = document.getElementById('payment-method')?.value;
            let disc = 0;
            
            if (appliedCoupon && method !== 'cod_full') {
                disc = appliedCoupon.value;
            }
            
            document.getElementById('sum-subtotal').innerText = formatPrice(subtotal);
            document.getElementById('sum-disc').innerText = `- ${formatPrice(disc)}`;
            document.getElementById('sum-total').innerText = formatPrice(Math.max(0, subtotal - disc));
        }

        function applyCoupon() {
            const code = document.getElementById('coupon-input').value.toUpperCase();
            const coupon = CONFIG.coupons.find(x => x.code === code);
            const msg = document.getElementById('coupon-msg');
            const method = document.getElementById('payment-method').value;
            const subtotal = cart.reduce((s, i) => s + (i.price * i.qty), 0);
            
            msg.classList.remove('hidden');
            
            if (method === 'cod_full') {
                msg.innerText = "Gagal! COD Full tidak dapat menggunakan kupon.";
                msg.style.color = '#EF4444';
                appliedCoupon = null;
            } else if (coupon) {
                if (subtotal >= coupon.minPurchase) {
                    appliedCoupon = coupon;
                    lastCheckoutData.coupon = coupon;
                    msg.innerText = "Kupon berhasil diterapkan!";
                    msg.style.color = '#059669';
                    msg.style.fontWeight = '600';
                } else {
                    appliedCoupon = null;
                    lastCheckoutData.coupon = null;
                    msg.innerText = `Minimal belanja ${formatPrice(coupon.minPurchase)}`;
                    msg.style.color = '#EF4444';
                }
            } else {
                appliedCoupon = null;
                lastCheckoutData.coupon = null;
                msg.innerText = "Kode kupon tidak valid";
                msg.style.color = '#EF4444';
            }
            
            updateCartSummary();
        }

        // ========== CHECKOUT FUNCTIONS ==========
        function proceedToCheckout() {
            if (cart.length === 0) return;
            closeCart();
            renderCheckout(lastCheckoutData.customer || {});
            openModal('checkout-modal');
        }

        function renderCheckout(data) {
            const content = document.getElementById('checkout-content');
            content.innerHTML = `
                <button onclick="backToCart()" class="absolute top-4 right-4 text-gray-400 p-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
                </button>
                <h3 class="font-bold text-lg mb-4">Data Pengiriman</h3>
                
                <input type="text" id="c-name" class="input-style" placeholder="Nama Lengkap *" value="${data.name || ''}">
                <input type="tel" id="c-phone" class="input-style" placeholder="Nomor WhatsApp *" value="${data.phone || ''}">
                <input type="text" id="c-address" class="input-style" placeholder="Alamat Lengkap (RT/RW + Desa) *" value="${data.address || ''}">
                <input type="text" id="c-district" class="input-style" placeholder="Kecamatan *" value="${data.district || ''}">
                <input type="text" id="c-city" class="input-style" placeholder="Kabupaten/Kota *" value="${data.city || ''}">
                <input type="text" id="c-prov" class="input-style" placeholder="Provinsi *" value="${data.prov || ''}">
                <input type="text" id="c-notes" class="input-style" placeholder="Catatan (Opsional)" value="${data.notes || ''}">
                
                <button onclick="generateInvoice()" class="btn-primary mt-2">Buat Pesanan</button>`;
        }

        function backToCart() {
            closeModal('checkout-modal');
            openCart();
        }

        // ========== INVOICE FUNCTIONS ==========
        function generateOrderId() {
            const date = new Date();
            const y = date.getFullYear().toString().slice(-2);
            const m = String(date.getMonth() + 1).padStart(2, '0');
            const d = String(date.getDate()).padStart(2, '0');
            const rand = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
            return `KM${y}${m}${d}-${rand}`;
        }

        function copyToClipboard(text, btn) {
            navigator.clipboard.writeText(text).then(() => {
                const originalText = btn.innerText;
                btn.innerText = 'Tersalin!';
                btn.style.background = '#059669';
                setTimeout(() => {
                    btn.innerText = originalText;
                    btn.style.background = '';
                }, 1500);
            });
        }

        function generateInvoice() {
            const name = document.getElementById('c-name').value.trim();
            const phone = document.getElementById('c-phone').value.trim();
            const address = document.getElementById('c-address').value.trim();
            const district = document.getElementById('c-district').value.trim();
            const city = document.getElementById('c-city').value.trim();
            const prov = document.getElementById('c-prov').value.trim();
            const notes = document.getElementById('c-notes').value.trim();
            const payMethod = lastCheckoutData.method;
            
            if (!name || !phone || !address || !district || !city || !prov) {
                alert("Mohon lengkapi semua data wajib!");
                return;
            }
            
            lastCheckoutData.customer = { name, phone, address, district, city, prov, notes };
            lastCheckoutData.coupon = appliedCoupon;
            
            const subtotal = cart.reduce((s, i) => s + (i.price * i.qty), 0);
            let disc = 0;
            if (payMethod !== 'cod_full' && appliedCoupon) {
                disc = appliedCoupon.value;
            }
            const total = Math.max(0, subtotal - disc);
            const orderId = generateOrderId();
            const dateStr = new Date().toLocaleDateString('id-ID', { day: 'numeric', month: 'long', year: 'numeric' });
            
            currentInvoice = {
                id: orderId,
                date: dateStr,
                customer: lastCheckoutData.customer,
                items: [...cart],
                subtotal,
                disc,
                total,
                payment: payMethod,
                notes,
                selectedBank: document.getElementById('transfer-bank')?.value || 'BRI'
            };
            
            cart = [];
            saveData();
            updateStickyBar();
            closeModal('checkout-modal');
            
            const selectedBank = currentInvoice.selectedBank;
            const filteredBank = CONFIG.bankAccounts.find(b => b.bank === selectedBank);
            
            let paymentInfoHtml = '';
            if (payMethod === 'cod_full') {
                paymentInfoHtml = `
                    <div style="margin-top:20px; border-top:1px dashed #ddd; padding-top:15px;">
                        <h4 style="color:#DC2626; font-weight:bold; margin-bottom:8px;">BAYAR DI TEMPAT (COD)</h4>
                        <p style="font-size:12px; color:#6B7280;">Total dibayar saat barang diterima.</p>
                    </div>`;
            } else {
                paymentInfoHtml = `
                    <div style="margin-top:20px; border-top:1px dashed #ddd; padding-top:15px;">
                        <h4 style="font-weight:bold; margin-bottom:10px;">INFORMASI PEMBAYARAN</h4>
                        <div class="bank-card-modern ${filteredBank.cardClass}">
                            <div class="bank-logo-container">
                                <div class="bank-logo-box ${filteredBank.logoClass}">${filteredBank.bank}</div>
                                <span class="bank-name-modern">${filteredBank.bank}</span>
                            </div>
                            <div class="bank-number-container">
                                <span class="bank-number-modern">${filteredBank.number}</span>
                                <button class="copy-btn" onclick="copyToClipboard('${filteredBank.number}', this)">Salin</button>
                            </div>
                            <div class="bank-owner-badge">a.n. ${filteredBank.name}</div>
                        </div>
                    </div>`;
            }
            
            const invoiceHtml = `
                <div class="invoice-card">
                    <div style="text-align:center; margin-bottom:20px;">
                        <img src="https://i.postimg.cc/3JZ3Y0K0/Logo-Kemoenik-jpg.jpg" style="width:60px; margin:0 auto 8px auto; display:block; border-radius:12px;">
                        <h2 style="font-size:16px; font-weight:800; color:#1F2937;">KEMOENIK OFFICIAL STORE</h2>
                        <p style="font-size:11px; color:#6B7280; margin-top:4px;">${CONFIG.storeAddress}</p>
                    </div>
                    
                    <hr style="margin:15px 0; border-style:dashed;">
                    
                    <h3 style="text-align:center; font-weight:bold; margin-bottom:20px; font-size:14px;">INVOICE PESANAN</h3>
                    
                    <div style="margin-bottom: 20px; font-size: 12px;">
                        <div style="display: flex; justify-content: space-between; border-bottom: 1px solid #f3f4f6; padding: 8px 0;">
                            <span style="font-weight: 600;">Order ID</span>
                            <span style="font-family: monospace;">#${orderId}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; border-bottom: 1px solid #f3f4f6; padding: 8px 0;">
                            <span>Tanggal</span>
                            <span>${dateStr}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 8px 0;">
                            <span>Status</span>
                            <span style="color: #D97706; font-weight: bold;">Menunggu Pembayaran</span>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px; font-size: 12px;">
                        <h4 style="font-weight: bold; margin-bottom: 8px; color:#374151;">DATA PEMBELI</h4>
                        <p style="color: #1F2937; font-weight: 600;">${name}</p>
                        <p style="color: #6B7280; font-size: 11px;">${phone}</p>
                        <p style="color: #9CA3AF; font-size: 11px; margin-top: 4px;">${address}, Kec. ${district}, ${city}, ${prov}</p>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <h4 style="font-weight: bold; margin-bottom: 12px; font-size: 12px;">DETAIL PESANAN</h4>
                        <table style="width: 100%; font-size: 11px; border-collapse: collapse;">
                            <thead>
                                <tr style="border-bottom: 1px solid #e5e7eb; background: #f9fafb;">
                                    <th style="text-align: left; padding: 8px;">Item</th>
                                    <th style="text-align: center; padding: 8px; width: 40px;">Qty</th>
                                    <th style="text-align: right; padding: 8px;">Subtotal</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${currentInvoice.items.map(i => `
                                    <tr style="border-bottom: 1px solid #f3f4f6;">
                                        <td style="padding: 8px;">${i.name}</td>
                                        <td style="padding: 8px; text-align: center;">${i.qty}</td>
                                        <td style="padding: 8px; text-align: right;">${formatPrice(i.price * i.qty)}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                    
                    <div style="background: #F0FDF4; padding: 16px; border-radius: 12px; font-size: 12px; margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 6px;"><span>Subtotal</span><span>${formatPrice(subtotal)}</span></div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 6px; color: #EF4444;"><span>Diskon</span><span>- ${formatPrice(disc)}</span></div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 6px;"><span>Ongkir</span><span style="color: #9CA3AF; font-size: 10px;">(Konfirmasi Admin)</span></div>
                        <div style="border-top: 1px solid #D1FAE5; margin-top: 10px; padding-top: 10px; display: flex; justify-content: space-between; font-weight: bold; font-size: 14px;">
                            <span>Total Bayar</span>
                            <span style="color: #059669;">${formatPrice(total)}</span>
                        </div>
                    </div>
                    
                    <div style="font-size: 11px; color: #374151; margin-bottom: 12px; font-weight: 600;">
                        Metode: ${payMethod === 'cod_full' ? 'COD Full (Bayar Ditempat)' : payMethod === 'cod_ongkir' ? 'COD Ongkir Saja' : 'Transfer Bank'}
                    </div>
                    
                    ${paymentInfoHtml}
                    
                    ${notes ? `<div style="margin-top: 16px; font-size: 11px; color: #6B7280; border-top: 1px solid #e5e7eb; padding-top: 12px;">Catatan: ${notes}</div>` : ''}

                    <div style="margin-top:24px; padding-top:16px; border-top:1px solid #e5e7eb; font-size:10px; text-align:center; color:#9CA3AF;">
                        <p style="font-weight: 600; color: #6B7280;">Terima kasih telah berbelanja!</p>
                        <p style="margin-top: 4px;">Pesanan akan diproses setelah konfirmasi pembayaran</p>
                    </div>
                </div>`;
            
            document.getElementById('invoice-container').innerHTML = invoiceHtml;
            openModal('invoiceModal');
        }

        function closeInvoice() {
            closeModal('invoiceModal');
            window.scrollTo(0, 0);
        }

        function editInvoice() {
            cart = [...currentInvoice.items];
            saveData();
            updateStickyBar();
            appliedCoupon = lastCheckoutData.coupon || null;
            closeModal('invoiceModal');
            openCart();
        }

        function printInvoice() {
            window.print();
        }

        function generateWAText() {
            const d = currentInvoice;
            const addr = d.customer;
            
            let text = `*INVOICE PESANAN*\n`;
            text += `====================\n`;
            text += `Order ID: #${d.id}\n`;
            text += `Tanggal: ${d.date}\n\n`;
            text += `*DATA PEMBELI*\n`;
            text += `Nama: ${addr.name}\n`;
            text += `No HP: ${addr.phone}\n`;
            text += `Alamat: ${addr.address}, Kec. ${addr.district}, ${addr.city}, ${addr.prov}\n\n`;
            text += `*DETAIL PESANAN*\n`;
            text += `-------------------\n`;
            d.items.forEach(i => {
                text += `${i.name}\n`;
                text += `${i.qty} x ${formatPrice(i.price)} = ${formatPrice(i.price * i.qty)}\n`;
            });
            text += `-------------------\n`;
            text += `Subtotal: ${formatPrice(d.subtotal)}\n`;
            text += `Diskon: ${formatPrice(d.disc)}\n`;
            text += `Ongkir: (Konfirmasi Admin)\n`;
            text += `*TOTAL: ${formatPrice(d.total)}*\n\n`;
            text += `Metode: ${d.payment === 'cod_full' ? 'COD Full' : d.payment === 'cod_ongkir' ? 'COD Ongkir' : 'Transfer'}\n`;
            if (d.notes) text += `\nCatatan: ${d.notes}`;
            return text;
        }

        function sendInvoiceWA() {
            const text = generateWAText();
            const url = `https://wa.me/${CONFIG.whatsappNumber}?text=${encodeURIComponent(text)}`;
            window.open(url, "_blank");
        }

        // ========== SEARCH FUNCTIONS ==========
        function toggleSearch() {
            document.getElementById('search-bar').classList.toggle('hidden');
            if (!document.getElementById('search-bar').classList.contains('hidden')) {
                document.getElementById('search-input').focus();
            }
        }

        function searchProducts() {
            const term = document.getElementById('search-input').value.toLowerCase().trim();
            
            // Filter produk yang active: true dan cocok dengan pencarian
            const filtered = CONFIG.products.filter(p => 
                p.active === true && 
                (p.name.toLowerCase().includes(term) || 
                p.desc.toLowerCase().includes(term))
            );
            
            activeCategory = 'all';
            renderCategories();
            
            const container = document.getElementById('product-grid');
            if (filtered.length === 0) {
                container.innerHTML = '<p class="col-span-2 text-center text-gray-400 py-12">Produk tidak ditemukan</p>';
            } else {
                container.innerHTML = filtered.map(p => {
                    const imgSrc = p.images?.[0] || 'https://placehold.co/400x400/F3F4F6/9CA3AF?text=No+Image';
                    const isWished = wishlist.some(w => w.id === p.id);
                    const finalPrice = p.price - Math.floor(p.price * (p.discount || 0) / 100);
                    
                    return `
                    <div class="product-card" onclick="openDetail(${p.id})">
                        <div class="product-img-wrapper">
                            <img src="${imgSrc}" class="product-img" alt="${p.name}" loading="lazy">
                            ${p.flashSale ? '<span class="flash-sale-badge">Flash Sale</span>' : ''}
                            ${p.discount > 0 ? `<span class="discount-badge">${p.discount}% OFF</span>` : ''}
                            <button onclick="event.stopPropagation(); toggleWishlist(${p.id})" class="wishlist-btn-card ${isWished ? 'active' : ''}">
                                <svg fill="${isWished ? '#ef4444' : 'none'}" stroke="${isWished ? '#ef4444' : '#9ca3af'}" stroke-width="2" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                                </svg>
                            </button>
                        </div>
                        <div class="product-info">
                            <h3 class="product-title">${p.name}</h3>
                            <div class="product-meta">
                                <span class="rating-stars">
                                    ${generateStars(p.rating)}
                                    <span class="ml-1 text-gray-600">${p.rating}</span>
                                </span>
                                <span class="sold-count">| ${formatSold(p.sold)} terjual</span>
                            </div>
                            <div class="product-price">${formatPrice(finalPrice)}</div>
                            ${p.originalPrice ? `<div class="product-price-original">${formatPrice(p.originalPrice)}</div>` : '<div style="height: 16px;"></div>'}
                            <button onclick="event.stopPropagation(); addCart(${p.id})" class="product-btn">+ Keranjang</button>
                        </div>
                    </div>`;
                }).join('');
            }
        }

        // ========== TRACKING FUNCTIONS ==========
        function openTracking() {
            document.getElementById('tracking-content').innerHTML = `
                <button onclick="closeTracking()" class="absolute top-4 right-4 text-gray-400 p-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
                </button>
                <h3 class="font-bold text-lg mb-4">Lacak Resi J&T</h3>
                <div class="flex gap-2 mb-6">
                    <input type="text" id="tracking-input" class="input-style mb-0 text-sm flex-1" placeholder="Masukkan No. Resi">
                    <button onclick="simulateTracking()" class="text-white px-4 rounded-xl text-xs font-bold" style="background: #1F2937;">Lacak</button>
                </div>
                <div id="tracking-result"></div>`;
            openModal('tracking-modal');
        }

        function closeTracking() {
            closeModal('tracking-modal');
        }

        function simulateTracking() {
            const resi = document.getElementById('tracking-input').value.trim();
            if (!resi) {
                alert("Masukkan nomor resi!");
                return;
            }
            
            const steps = ["Paket Diproses di Gudang", "Menuju Transit Hub", "Dalam Perjalanan", "Dibawa Kurir", "Terkirim"];
            const current = Math.floor(Math.random() * 5);
            
            let html = `<h4 class="font-bold mb-4 text-sm">Resi: ${resi}</h4>`;
            steps.forEach((s, i) => {
                const isActive = i <= current;
                html += `
                    <div class="relative pl-6 pb-4">
                        <div class="absolute left-0 top-1 w-3 h-3 rounded-full ${isActive ? 'bg-emerald-500' : 'bg-gray-300'}"></div>
                        ${i < steps.length - 1 ? `<div class="absolute left-[5px] top-4 w-0.5 h-full ${i < current ? 'bg-emerald-500' : 'bg-gray-200'}"></div>` : ''}
                        <p class="font-medium text-sm ${isActive ? 'text-gray-800' : 'text-gray-400'}">${s}</p>
                    </div>`;
            });
            
            document.getElementById('tracking-result').innerHTML = html;
        }

        // ========== KEYBOARD SCROLL FIX ==========
        document.addEventListener("focusin", function(e) {
            if (e.target.tagName === "INPUT" || e.target.tagName === "TEXTAREA" || e.target.tagName === "SELECT") {
                setTimeout(() => {
                    e.target.scrollIntoView({ behavior: "smooth", block: "center" });
                }, 300);
            }
        });
    </script>
</body>
</html>




