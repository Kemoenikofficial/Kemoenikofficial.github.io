<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Toko Resmi Kemoenik</title>
    <meta name="description" content="Toko online terpercaya dengan harga terbaik.">
    
    <!-- SEO -->
    <meta property="og:title" content="Toko Resmi Kemoenik" />
    <meta property="og:description" content="Flash Sale & Voucher Ongkir 15rb!" />
    <meta property="og:image" content="https://placehold.co/1200x630/FFFFFF/000000?text=Kemoenik" />
    <meta property="og:type" content="website" />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        :root {
            --primary-text: #000000;
            --secondary-text: #6b7280;
            --price-color: #ef4444;
            --bg-gradient-start: #22C55E;
            --bg-gradient-end: #FACC15;
        }
        * { font-family: 'Poppins', 'Arial', sans-serif; }
        body { background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%); min-height: 100vh; }
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #888; border-radius: 10px; }
        .fade-in { animation: fadeIn 0.5s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .slider-track { display: flex; transition: transform 0.6s cubic-bezier(0.25, 1, 0.5, 1); }
        .slide { min-width: 100%; }
        .sticky-btn { position: fixed; right: 20px; z-index: 999; width: 55px; height: 55px; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 15px rgba(0,0,0,0.15); cursor: pointer; transition: all 0.3s; }
        .sticky-btn:hover { transform: scale(1.1); }
        .sticky-cart { bottom: 90px; background: white; color: black; border: 1px solid #eee; }
        .sticky-wa { bottom: 25px; background: #25D366; color: white; }
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 1000; display: none; align-items: center; justify-content: center; padding: 15px; }
        .modal-overlay.active { display: flex; }
        .modal-content { background: white; border-radius: 20px; width: 100%; max-width: 450px; max-height: 90vh; overflow-y: auto; position: relative; animation: popIn 0.3s ease; }
        @keyframes popIn { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .input-form { width: 100%; border: 1px solid #e5e7eb; padding: 12px; border-radius: 12px; font-size: 14px; transition: all 0.3s; outline: none; }
        .input-form:focus { border-color: #22C55E; box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.2); }
    </style>
</head>
<body class="text-gray-800">

    <!-- HEADER -->
    <header class="sticky top-0 z-50 bg-white/95 backdrop-blur border-b border-gray-100 shadow-sm">
        <div class="container mx-auto px-4 py-3">
            <div class="flex justify-between items-center mb-3">
                <div class="flex items-center gap-2">
                    <img src="https://i.postimg.cc/3JZ3Y0K0/Logo-Kemoenik-jpg.jpg" alt="Logo" class="h-10 w-10 rounded-lg object-cover shadow-sm">
                    <h1 class="text-lg font-bold text-gray-800">KEMOENIK</h1>
                </div>
                <nav class="hidden md:flex items-center gap-6 text-sm font-medium text-gray-600">
                    <a href="#" class="hover:text-black">Beranda</a>
                    <a href="#produk" class="hover:text-black">Produk</a>
                    <a href="#" class="hover:text-black">Tentang Kami</a>
                </nav>
                <button onclick="openCart()" class="relative p-2 hover:bg-gray-100 rounded-full">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"/></svg>
                    <span id="cart-count-header" class="absolute -top-1 -right-1 bg-red-500 text-white text-[10px] w-5 h-5 rounded-full flex items-center justify-center font-bold hidden">0</span>
                </button>
            </div>
            <div class="relative">
                <input type="text" id="searchInput" placeholder="Cari produk impianmu..." class="w-full bg-gray-100 border-none rounded-xl py-2.5 pl-10 pr-4 text-sm focus:outline-none focus:ring-2 focus:ring-green-500 transition">
                <svg class="w-5 h-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
            </div>
        </div>
    </header>

    <!-- INFO FLASH SALE (Sekarang dari CONFIG) -->
    <section class="bg-white border-b border-gray-100 py-3 shadow-sm">
        <div class="container mx-auto px-4 flex flex-col md:flex-row justify-center items-center gap-2 text-center">
            <span id="promo-title-badge" class="bg-red-100 text-red-600 text-xs font-bold px-3 py-1 rounded-full uppercase"></span>
            <p id="promo-desc-text" class="text-sm text-gray-600 font-medium"></p>
        </div>
    </section>

    <!-- HERO SLIDER -->
    <section class="overflow-hidden relative bg-white shadow-sm">
        <div id="hero-slider" class="slider-track"></div>
        <button onclick="slideMove(-1)" class="absolute left-2 top-1/2 -translate-y-1/2 bg-white/80 p-1.5 rounded-full shadow hover:bg-white transition"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg></button>
        <button onclick="slideMove(1)" class="absolute right-2 top-1/2 -translate-y-1/2 bg-white/80 p-1.5 rounded-full shadow hover:bg-white transition"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg></button>
        <div class="absolute bottom-3 left-1/2 -translate-x-1/2 flex gap-1.5 z-10" id="slider-dots"></div>
    </section>

    <!-- KATALOG PRODUK -->
    <main class="container mx-auto px-4 py-8" id="produk">
        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3 md:gap-4" id="product-grid"></div>
    </main>

    <!-- FOOTER -->
    <footer class="bg-white text-gray-700 mt-12 shadow-inner">
        <div class="container mx-auto px-4 py-10 grid grid-cols-1 md:grid-cols-3 gap-8 text-sm">
            <div>
                <div class="flex items-center gap-2 mb-4">
                    <img src="https://i.postimg.cc/3JZ3Y0K0/Logo-Kemoenik-jpg.jpg" class="h-8 w-8 rounded-lg">
                    <h3 class="font-bold text-lg text-gray-800">KEMOENIK</h3>
                </div>
                <p class="leading-relaxed text-gray-600">Kp Cibubuay, Des cibodas, Kec Pasirjambu, Kab Bandung, Kota Bandung, Kode Pos 40972</p>
            </div>
            <div>
                <h4 class="font-bold mb-4 text-gray-800">Layanan Pelanggan</h4>
                <p class="mb-1 text-gray-600">Buka Setiap hari: 09.00 - 18.00</p>
                <p class="text-gray-500 text-xs">Fast Response via WhatsApp</p>
            </div>
            <div>
                <h4 class="font-bold mb-4 text-gray-800">Ikuti Kami</h4>
                <a href="https://instagram.com/kemoenik26" target="_blank" class="inline-flex items-center gap-2 text-pink-600 hover:underline font-medium">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg>
                    kemoenik26
                </a>
            </div>
        </div>
        <div class="border-t border-gray-100 py-4 text-center text-xs text-gray-400">&copy; 2024 Kemoenik. All rights reserved.</div>
    </footer>

    <!-- TOMBOL MENGAMBANG -->
    <div onclick="openCart()" class="sticky-btn sticky-cart">
        <span id="cart-count-sticky" class="absolute -top-1 -right-1 bg-red-500 text-white text-[10px] w-5 h-5 rounded-full flex items-center justify-center font-bold">0</span>
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"/></svg>
    </div>
    <a id="wa-link" href="#" target="_blank" class="sticky-btn sticky-wa">
        <svg class="w-7 h-7" fill="currentColor" viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>
    </a>

    <!-- MODAL KERANJANG -->
    <div id="cart-modal" class="modal-overlay">
        <div class="modal-content p-6">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold">Keranjang</h3>
                <button onclick="closeCart()" class="p-1 hover:bg-gray-100 rounded-full"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg></button>
            </div>
            <div id="cart-items" class="space-y-4 max-h-60 overflow-y-auto"></div>
            <div id="cart-empty" class="text-center py-10 text-gray-400 hidden">
                <svg class="w-12 h-12 mx-auto mb-2 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/></svg>
                Keranjang kosong.
            </div>
            <div class="border-t mt-6 pt-4 space-y-3" id="cart-footer" style="display:none;">
                <div class="flex justify-between text-lg font-bold">
                    <span>Total:</span>
                    <span id="cart-total" class="text-red-500">Rp 0</span>
                </div>
                <button onclick="proceedToCheckout()" class="w-full bg-black text-white py-3 rounded-xl font-semibold hover:bg-gray-800 transition">Checkout Sekarang</button>
            </div>
        </div>
    </div>

    <!-- MODAL DETAIL PRODUK -->
    <div id="detail-modal" class="modal-overlay">
        <div class="modal-content max-w-md">
            <div id="detail-content"></div>
        </div>
    </div>

    <!-- MODAL CHECKOUT -->
    <div id="checkout-modal" class="modal-overlay">
        <div class="modal-content p-6">
            <button onclick="closeCheckout()" class="absolute top-4 right-4 p-1 hover:bg-gray-100 rounded-full"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg></button>
            <h3 class="text-xl font-bold mb-4">Checkout</h3>
            <div class="space-y-3 mb-4">
                <input type="text" id="input-name" placeholder="Nama Lengkap *" class="input-form" required>
                <input type="tel" id="input-phone" placeholder="No. WhatsApp *" class="input-form" required>
                <textarea id="input-address" placeholder="Alamat Lengkap (Kecamatan, Kode Pos) *" class="input-form" rows="3" required></textarea>
            </div>
            <div class="bg-yellow-50 border border-yellow-200 p-3 rounded-lg mb-4 text-xs text-yellow-800 flex items-start gap-2">
                <svg class="w-4 h-4 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                <span>Setelah klik "Bayar Sekarang", Anda akan diarahkan ke WhatsApp. Silakan kirim <b>Bukti Transfer</b> Anda di sana.</span>
            </div>
            <div class="bg-gray-50 p-4 rounded-lg mb-4 text-sm">
                <h4 class="font-semibold mb-2 text-gray-700">Ringkasan Pesanan:</h4>
                <div id="checkout-summary" class="space-y-1 text-gray-600"></div>
                <div class="border-t mt-2 pt-2 font-bold flex justify-between">
                    <span>Total Transfer:</span>
                    <span id="checkout-total" class="text-red-500"></span>
                </div>
            </div>
            <div class="mb-6">
                <h4 class="font-semibold mb-2 text-sm text-gray-700">Silakan transfer ke:</h4>
                <div id="bank-list" class="space-y-2"></div>
                <div class="mt-3 border p-2 rounded-lg bg-blue-50 text-center">
                    <p class="text-[10px] text-gray-500 mb-1">Scan QRIS:</p>
                    <img id="qris-image" src="" alt="QRIS" class="mx-auto w-32 h-32 object-contain rounded bg-white p-1">
                </div>
            </div>
            <button onclick="confirmPayment()" class="w-full bg-green-500 text-white py-3 rounded-xl font-semibold hover:bg-green-600 transition flex items-center justify-center gap-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                Bayar Sekarang
            </button>
        </div>
    </div>

    <!-- JAVASCRIPT -->
    <script>
        /* ===========================================================
           KONFIGURASI TOKO
           =========================================================== */
        const CONFIG = {
            storeName: "KEMOENIK",
            whatsappNumber: "6281546450547", 
            
            // =========================================================
            // UBAH TEKS FLASH SALE DI SINI
            // =========================================================
            promoTitle: "Flash Sale",
            promoText: "Dapatkan Voucher Ongkir 15rb untuk setiap pembelian diatas 120 Ribu.",
            
            bankAccounts: [
                { bank: "Bank BRI", number: "000501168248506", name: "DANI RAMDANI" },
                { bank: "DANA", number: "081546450547", name: "DANI RAMDANI" },
                { bank: "SEA BANK", number: "901851870313", name: "DANI RAMDANI" }
            ],
            qrisImage: "https://placehold.co/200x200/FFFFFF/000000?text=QRIS+ANDA",
            sliders: [
                "https://placehold.co/800x400/22C55E/FFFFFF?text=Banner+Promo+1",
                "https://placehold.co/800x400/FACC15/000000?text=Banner+Promo+2",
                "https://placehold.co/800x400/FFFFFF/000000?text=Banner+Promo+3",
                "https://placehold.co/800x400/22C55E/FFFFFF?text=Banner+Promo+4",
                "https://placehold.co/800x400/FACC15/000000?text=Banner+Promo+5"
            ]
        };

        /* ===========================================================
           DATA PRODUK (Gunakan backtick ` untuk deskripsi panjang)
           =========================================================== */
        let productsData = [
            {
                id: 1,
                name: "CALCULATOR FAT LOSS",
                price: 30000,
                discount: 50,
                image: "https://placehold.co/400x400/eee/333?text=Calculator",
                sold: 150,
                rating: 4.9,
                desc: `CALCULATOR FAT LOSS membantu kamu untuk mengetahui kebutuhan kalori pemeliharaan, penurunan berat badan, serta mengetahui berapa lama dapat mencapai bb keinginamu.`,
                reviews: [
                    {user: "Budi", text: "Calculatornya mudah dipahami dan gampang banget ga bikin pusing, untuk pemula cocok!", rate: 5}, 
                    {user: "Ani", text: "Wihh bagus banget saya jadi tau hitunganya ketika mau turun bb", rate: 5}
                ] 
            },
            {
                id: 2,
                name: "(Grand Launching) KEMOENIK SLIM",
                price: 0,
                discount: 0,  // Diubah dari 100 agar masuk akal
                image: "https://placehold.co/400x400/eee/333?text=Slim+1",
                sold: 89,
                rating: 4.9,
                desc: `Produk premium untuk menunjang penampilan Anda. Bahan nyaman dan berkualitas tinggi.`,
                reviews: [{user: "Dedi", text: "Kualitas terbaik.", rate: 5}]
            },
            {
                id: 3,
                name: "(Grand Launching) KEMOENIK SLIM 2",
                price: 0,
                discount: 20,
                image: "https://placehold.co/400x400/eee/333?text=Slim+2",
                sold: 230,
                rating: 4.9,
                desc: `Produk kedua dari seri Kemoenik Slim dengan fitur lebih lengkap.`,
                reviews: [{user: "Sari", text: "Mantap!", rate: 5}]
            },
            {
                id: 4,
                name: "(Grand Launching) KEMOENIK SLIM 3",
                price: 0,
                discount: 0,
                image: "https://placehold.co/400x400/eee/333?text=Slim+3",
                sold: 45,
                rating: 4.9,
                desc: `Edisi ketiga dengan desain eksklusif dan terbatas.`,
                reviews: []  // Diperbaiki: array kosong yang benar
            },
            {
                id: 5,
                name: "(Grand Launching) KEMOENIK SLIM 4",
                price: 0,
                discount: 0,
                image: "https://placehold.co/400x400/eee/333?text=Slim+4",
                sold: 500,
                rating: 4.9,
                desc: `Edisi spesial dengan bonus eksklusif untuk pembelian pertama.`,
                reviews: [{user: "Riko", text: "Keren abis.", rate: 5}]
            }
        ];

        // LOGIC ENGINE
        const storedSold = JSON.parse(localStorage.getItem('productSold'));
        if (storedSold) {
            productsData = productsData.map(p => storedSold[p.id] ? {...p, sold: storedSold[p.id]} : p);
        }

        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        let currentSlide = 0;

        document.addEventListener('DOMContentLoaded', () => {
            renderSlider();
            renderProducts(productsData);
            updateCartUI();
            applyConfig();
            
            document.getElementById('searchInput').addEventListener('keyup', (e) => {
                const term = e.target.value.toLowerCase();
                const filtered = productsData.filter(p => p.name.toLowerCase().includes(term));
                renderProducts(filtered);
            });
        });

        function applyConfig() {
            document.getElementById('wa-link').href = `https://wa.me/${CONFIG.whatsappNumber}`;
            document.getElementById('qris-image').src = CONFIG.qrisImage;
            // Terapkan Promo Text dari CONFIG
            document.getElementById('promo-title-badge').innerText = CONFIG.promoTitle;
            document.getElementById('promo-desc-text').innerText = CONFIG.promoText;
        }

        // SLIDER
        function renderSlider() {
            const track = document.getElementById('hero-slider');
            const dots = document.getElementById('slider-dots');
            track.innerHTML = CONFIG.sliders.map(img => `<div class="slide"><img src="${img}" class="w-full h-48 md:h-72 object-cover" alt="Banner"></div>`).join('');
            dots.innerHTML = CONFIG.sliders.map((_, i) => `<button onclick="goToSlide(${i})" class="w-2 h-2 rounded-full transition ${i === 0 ? 'bg-gray-800 w-4' : 'bg-gray-400'}"></button>`).join('');
        }
        function updateSlider() {
            const track = document.getElementById('hero-slider');
            track.style.transform = `translateX(-${currentSlide * 100}%)`;
            document.querySelectorAll('#slider-dots button').forEach((dot, i) => dot.className = `w-2 h-2 rounded-full transition ${i === currentSlide ? 'bg-gray-800 w-4' : 'bg-gray-400'}`);
        }
        function slideMove(d) { currentSlide = (currentSlide + d + CONFIG.sliders.length) % CONFIG.sliders.length; updateSlider(); }
        function goToSlide(i) { currentSlide = i; updateSlider(); }
        setInterval(() => slideMove(1), 4000);

        // KATALOG
        function renderProducts(data) {
            const grid = document.getElementById('product-grid');
            grid.innerHTML = data.map(p => {
                const finalPrice = p.price - (p.price * p.discount / 100);
                return `
                <div onclick="openDetail(${p.id})" class="bg-white rounded-xl overflow-hidden shadow hover:shadow-lg transition duration-300 cursor-pointer group fade-in flex flex-col">
                    <div class="relative overflow-hidden">
                        <img src="${p.image}" alt="${p.name}" class="w-full aspect-square object-cover group-hover:scale-105 transition duration-300">
                        ${p.discount > 0 ? `<span class="absolute top-2 left-2 bg-red-500 text-white text-[10px] py-1 px-2 rounded-lg font-bold">${p.discount}%</span>` : ''}
                    </div>
                    <div class="p-3 flex-1 flex flex-col justify-between">
                        <div>
                            <h3 class="font-semibold text-gray-800 text-sm leading-tight line-clamp-2">${p.name}</h3>
                            <div class="mt-1">
                                <span class="text-red-500 font-bold text-sm">Rp ${finalPrice.toLocaleString('id-ID')}</span>
                                ${p.discount > 0 ? `<span class="text-gray-400 text-[10px] line-through ml-1">Rp ${p.price.toLocaleString('id-ID')}</span>` : ''}
                            </div>
                            <div class="flex items-center gap-1 mt-1.5 text-gray-500 text-xs">
                                <svg class="w-3.5 h-3.5 text-yellow-400 fill-current" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                <span>${p.rating}</span>
                                <span class="mx-1">|</span>
                                <span>Terjual ${p.sold}</span>
                            </div>
                        </div>
                    </div>
                </div>
            `}).join('');
        }

        // DETAIL PRODUK
        function openDetail(id) {
            const p = productsData.find(x => x.id === id);
            if(!p) return;
            const finalPrice = p.price - (p.price * p.discount / 100);
            const stars = Array(5).fill(0).map((_, i) => i < Math.floor(p.rating) ? 'text-yellow-400' : 'text-gray-300').map(c => `<svg class="w-4 h-4 ${c}" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>`).join('');

            document.getElementById('detail-content').innerHTML = `
                <div class="relative">
                    <img src="${p.image}" class="w-full aspect-square object-cover">
                    <button onclick="closeDetail()" class="absolute top-3 right-3 bg-white p-1.5 rounded-full shadow hover:bg-gray-100"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg></button>
                </div>
                <div class="p-5">
                    <div class="flex justify-between items-start mb-2">
                        <h2 class="text-lg font-bold text-gray-800 flex-1 pr-2">${p.name}</h2>
                        <div class="flex items-center gap-1">${stars}</div>
                    </div>
                    <div class="mb-4">
                        <span class="text-red-500 text-xl font-bold">Rp ${finalPrice.toLocaleString('id-ID')}</span>
                        ${p.discount > 0 ? `<span class="text-sm text-gray-400 line-through ml-2">Rp ${p.price.toLocaleString('id-ID')}</span>` : ''}
                    </div>
                    <div class="flex gap-2 text-xs text-gray-500 mb-4 border-b pb-4">
                        <span class="bg-gray-100 px-2 py-1 rounded">Terjual ${p.sold}</span>
                        <span class="bg-gray-100 px-2 py-1 rounded">Rating ${p.rating}</span>
                    </div>
                    <div class="mb-6">
                        <h4 class="font-semibold mb-1 text-gray-700">Deskripsi</h4>
                        <p class="text-sm text-gray-600 leading-relaxed">${p.desc}</p>
                    </div>
                    ${p.reviews.length > 0 ? `
                    <div class="mb-6">
                        <h4 class="font-semibold mb-2 text-gray-700">Penilaian Pembeli</h4>
                        <div class="space-y-2 max-h-32 overflow-y-auto">
                            ${p.reviews.map(r => `<div class="bg-gray-50 p-2 rounded text-xs"><div class="flex justify-between mb-1"><span class="font-semibold">${r.user}</span><span class="text-yellow-400">${'â˜…'.repeat(r.rate)}</span></div><p class="text-gray-500">${r.text}</p></div>`).join('')}
                        </div>
                    </div>` : ''}
                    <div class="flex gap-2 mt-4">
                        <button onclick="addToCart(${p.id})" class="flex-1 bg-white border-2 border-black text-black py-3 rounded-xl font-semibold hover:bg-gray-100 transition flex items-center justify-center gap-2">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"/></svg>
                            Keranjang
                        </button>
                        <button onclick="buyNow(${p.id})" class="flex-1 bg-black text-white py-3 rounded-xl font-semibold hover:bg-gray-800 transition">Beli Sekarang</button>
                    </div>
                    <div onclick="closeDetail(); window.scrollTo(0,0);" class="mt-6 pt-4 border-t flex items-center justify-center gap-2 cursor-pointer hover:opacity-70 transition">
                        <img src="https://i.postimg.cc/3JZ3Y0K0/Logo-Kemoenik-jpg.jpg" class="w-6 h-6 rounded">
                        <span class="font-bold text-sm text-gray-700">${CONFIG.storeName}</span>
                    </div>
                </div>`;
            document.getElementById('detail-modal').classList.add('active');
        }
        function closeDetail() { document.getElementById('detail-modal').classList.remove('active'); }

        // KERANJANG
        function addToCart(id) {
            const p = productsData.find(x => x.id === id);
            const exist = cart.find(i => i.id === id);
            if (exist) exist.qty++;
            else {
                const finalPrice = p.price - (p.price * p.discount / 100);
                cart.push({id: p.id, name: p.name, price: finalPrice, image: p.image, qty: 1});
            }
            saveCart();
            closeDetail();
            openCart();
        }
        function buyNow(id) { addToCart(id); proceedToCheckout(); }
        function updateCartUI() {
            const count = cart.reduce((s, i) => s + i.qty, 0);
            document.getElementById('cart-count-sticky').innerText = count;
            document.getElementById('cart-count-header').innerText = count;
            document.getElementById('cart-count-header').classList.toggle('hidden', count === 0);
            renderCartItems();
        }
        function renderCartItems() {
            const container = document.getElementById('cart-items');
            const empty = document.getElementById('cart-empty');
            const footer = document.getElementById('cart-footer');
            if (cart.length === 0) { container.innerHTML = ''; empty.classList.remove('hidden'); footer.style.display = 'none'; return; }
            empty.classList.add('hidden'); footer.style.display = 'block';
            let total = 0;
            container.innerHTML = cart.map(item => {
                total += item.price * item.qty;
                return `<div class="flex gap-3 items-center border-b pb-3">
                    <img src="${item.image}" class="w-16 h-16 rounded-lg object-cover">
                    <div class="flex-1"><h4 class="font-medium text-sm">${item.name}</h4>
                        <p class="text-red-500 font-semibold text-sm">Rp ${item.price.toLocaleString('id-ID')}</p>
                        <div class="flex items-center gap-2 mt-1">
                            <button onclick="updateQty(${item.id}, -1)" class="w-6 h-6 bg-gray-100 rounded-full text-xs font-bold hover:bg-gray-200">-</button>
                            <span class="text-sm font-medium">${item.qty}</span>
                            <button onclick="updateQty(${item.id}, 1)" class="w-6 h-6 bg-gray-100 rounded-full text-xs font-bold hover:bg-gray-200">+</button>
                        </div>
                    </div>
                    <button onclick="removeItem(${item.id})" class="text-red-400 hover:text-red-600 text-xs">Hapus</button>
                </div>`;
            }).join('');
            document.getElementById('cart-total').innerText = `Rp ${total.toLocaleString('id-ID')}`;
        }
        function saveCart() { localStorage.setItem('cart', JSON.stringify(cart)); updateCartUI(); }
        function updateQty(id, d) { const i = cart.find(x => x.id === id); if(i) { i.qty += d; if(i.qty <= 0) cart = cart.filter(x => x.id !== id); saveCart(); } }
        function removeItem(id) { cart = cart.filter(x => x.id !== id); saveCart(); }
        function openCart() { document.getElementById('cart-modal').classList.add('active'); renderCartItems(); }
        function closeCart() { document.getElementById('cart-modal').classList.remove('active'); }

        // CHECKOUT
        function proceedToCheckout() {
            closeCart();
            let total = 0;
            const summary = cart.map(item => {
                total += item.price * item.qty;
                return `<p>${item.name} (${item.qty}x) - <b>Rp ${item.price.toLocaleString('id-ID')}</b></p>`;
            }).join('');
            document.getElementById('checkout-summary').innerHTML = summary;
            document.getElementById('checkout-total').innerText = `Rp ${total.toLocaleString('id-ID')}`;
            document.getElementById('bank-list').innerHTML = CONFIG.bankAccounts.map(b => `
                <div class="bg-gray-50 p-2 rounded text-xs border flex justify-between items-center">
                    <div><p class="font-bold text-gray-700">${b.bank}</p><p class="font-mono text-gray-500">${b.number}</p></div>
                    <span class="text-[10px] text-gray-400">a.n ${b.name}</span>
                </div>
            `).join('');
            document.getElementById('checkout-modal').classList.add('active');
        }
        function closeCheckout() { document.getElementById('checkout-modal').classList.remove('active'); }

        // KONFIRMASI
        function confirmPayment() {
            const name = document.getElementById('input-name').value;
            const phone = document.getElementById('input-phone').value;
            const address = document.getElementById('input-address').value;
            if (!name || !phone || !address) { alert("Harap lengkapi Nama, No HP, dan Alamat sebelum bayar."); return; }

            const soldData = JSON.parse(localStorage.getItem('productSold')) || {};
            cart.forEach(item => { soldData[item.id] = (soldData[item.id] || 0) + item.qty; });
            localStorage.setItem('productSold', JSON.stringify(soldData));
            productsData = productsData.map(p => soldData[p.id] ? {...p, sold: soldData[p.id]} : p);
            renderProducts(productsData);

            let msg = `Halo Admin ${CONFIG.storeName}, saya ingin memesan:\n\n`;
            msg += `*Data Pembeli:*\nNama: ${name}\nNo HP: ${phone}\nAlamat: ${address}\n\n`;
            msg += `*Detail Pesanan:*\n`;
            let total = 0;
            cart.forEach(item => {
                total += item.price * item.qty;
                msg += `- ${item.name} (${item.qty}x) : Rp ${item.price.toLocaleString('id-ID')}\n`;
            });
            msg += `\n*Total: Rp ${total.toLocaleString('id-ID')}*\n\n`;
            msg += `Saya sudah melakukan pembayaran, mohon segera diproses.`;

            window.open(`https://wa.me/${CONFIG.whatsappNumber}?text=${encodeURIComponent(msg)}`, '_blank');

            localStorage.removeItem('cart');
            cart = [];
            updateCartUI();
            closeCheckout();
        }

        window.onclick = (e) => {
            if (e.target.id === 'cart-modal') closeCart();
            if (e.target.id === 'detail-modal') closeDetail();
            if (e.target.id === 'checkout-modal') closeCheckout();
        }
    </script>
</body>
</html>

