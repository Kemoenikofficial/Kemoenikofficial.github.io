<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>KEMOENIK OFFICIAL</title>

<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

<style>
body { background: #f5f7fa; font-family: sans-serif; }
.modal { position:fixed; inset:0; background:rgba(0,0,0,.4); display:none; justify-content:center; align-items:flex-end; z-index:999; }
.modal.active { display:flex; }
.modal-box { background:white; width:100%; max-width:500px; border-radius:20px 20px 0 0; padding:20px; max-height:90vh; overflow:auto; padding-bottom:120px; }
.invoice-card { background:white; padding:30px; border-radius:16px; }
body.no-scroll { overflow:hidden; }

@media print {
  body * { visibility:hidden; }
  #invoiceModal, #invoiceModal * { visibility:visible; }
  #invoiceModal { position:absolute; inset:0; }
}

@page { size:A4; margin:15mm; }
</style>
</head>

<body>

<div class="p-4">
<h1 class="text-xl font-bold text-center mb-4">KEMOENIK</h1>

<button onclick="openCheckout()" class="bg-green-600 text-white w-full py-3 rounded-xl font-bold">
Checkout
</button>
</div>

<!-- CHECKOUT -->
<div id="checkoutModal" class="modal">
<div class="modal-box">
<h3 class="font-bold mb-3">Isi Data Pengiriman</h3>

<input id="name" class="border p-2 w-full mb-2 rounded" placeholder="Nama">
<input id="phone" class="border p-2 w-full mb-2 rounded" placeholder="No WA">
<input id="address" class="border p-2 w-full mb-2 rounded" placeholder="Alamat">

<select id="paymentMethod" class="border p-2 w-full mb-2 rounded" onchange="toggleTransfer()">
<option value="transfer">Transfer Produk + Ongkir</option>
<option value="cod_ongkir">COD Ongkir Saja</option>
<option value="cod_full">COD Full</option>
</select>

<div id="transferBox" class="mb-3">
<select id="bankSelect" class="border p-2 w-full rounded">
<option value="BRI">BRI</option>
<option value="DANA">DANA</option>
<option value="SeaBank">SeaBank</option>
</select>
</div>

<button onclick="generateInvoice()" class="bg-green-600 text-white w-full py-3 rounded-xl font-bold">
Buat Invoice
</button>

</div>
</div>

<!-- INVOICE -->
<div id="invoiceModal" class="modal">
<div class="modal-box">

<div id="invoiceContent"></div>

<div class="mt-4 flex gap-2">
<button onclick="printInvoice()" class="bg-gray-800 text-white flex-1 py-3 rounded-xl">
Cetak
</button>
<button onclick="sendWA()" class="bg-green-600 text-white flex-1 py-3 rounded-xl">
Kirim WA
</button>
</div>

<button onclick="closeInvoice()" class="text-center w-full mt-3 text-gray-500">
Tutup
</button>

</div>
</div>

<script>
const CONFIG = {
whatsapp:"6281546450547",
banks:{
BRI:{number:"000501168248506", name:"DANI RAMDANI"},
DANA:{number:"081546450547", name:"DANI RAMDANI"},
SeaBank:{number:"901851870313", name:"DANI RAMDANI"}
}
};

let currentInvoice={};

function openCheckout(){
document.getElementById("checkoutModal").classList.add("active");
document.body.classList.add("no-scroll");
}

function closeCheckout(){
document.getElementById("checkoutModal").classList.remove("active");
document.body.classList.remove("no-scroll");
}

function closeInvoice(){
document.getElementById("invoiceModal").classList.remove("active");
document.body.classList.remove("no-scroll");
}

function toggleTransfer(){
const method=document.getElementById("paymentMethod").value;
if(method==="cod_full"){
document.getElementById("transferBox").style.display="none";
}else{
document.getElementById("transferBox").style.display="block";
}
}

function generateInvoice(){

const name=document.getElementById("name").value;
const phone=document.getElementById("phone").value;
const address=document.getElementById("address").value;
const method=document.getElementById("paymentMethod").value;
const bank=document.getElementById("bankSelect").value;

if(!name||!phone||!address){
alert("Lengkapi data");
return;
}

const orderId="KM"+Date.now().toString().slice(-6);
const date=new Date().toLocaleDateString("id-ID");

currentInvoice={orderId,name,phone,address,method,bank};

let paymentHTML="";

if(method==="cod_full"){
paymentHTML=`
<div class="mt-6 border-t pt-4">
<h4 class="font-bold text-red-600">COD FULL</h4>
<p>Bayar saat barang diterima</p>
</div>`;
}else{
const b=CONFIG.banks[bank];
paymentHTML=`
<div class="mt-6 border-t pt-4">
<h4 class="font-bold mb-2">Informasi Pembayaran</h4>
<p><b>${bank}</b></p>
<p>${b.number}</p>
<p>a.n ${b.name}</p>
</div>`;
}

document.getElementById("invoiceContent").innerHTML=`
<div class="invoice-card">

<div class="text-center mb-4">
<img src="https://i.postimg.cc/3JZ3Y0K0/Logo-Kemoenik-jpg.jpg" style="width:60px;margin:auto;">
<h2 class="font-bold text-lg mt-2">KEMOENIK OFFICIAL</h2>
<p class="text-xs text-gray-500">Kab Bandung</p>
</div>

<hr class="my-3">

<h3 class="text-center font-bold mb-4">INVOICE PESANAN PRODUK</h3>

<p><b>Order ID:</b> ${orderId}</p>
<p><b>Tanggal:</b> ${date}</p>

<div class="mt-4">
<h4 class="font-bold">Data Pembeli</h4>
<p>${name}</p>
<p>${phone}</p>
<p>${address}</p>
</div>

${paymentHTML}

</div>
`;

closeCheckout();
document.getElementById("invoiceModal").classList.add("active");
document.body.classList.add("no-scroll");
}

function sendWA(){
const text=`Halo Admin, saya sudah order dengan ID ${currentInvoice.orderId}`;
const url=`https://wa.me/${CONFIG.whatsapp}?text=${encodeURIComponent(text)}`;
const isIOS=/iPhone|iPad|iPod/i.test(navigator.userAgent);

if(isIOS){
window.location.href=url;
}else{
window.open(url,"_blank");
}

setTimeout(()=>{
document.getElementById("invoiceModal").classList.add("active");
},600);
}

function printInvoice(){
window.print();
}

window.addEventListener("resize",()=>{
document.querySelectorAll(".modal-box").forEach(el=>{
el.scrollTop=el.scrollHeight;
});
});
</script>

</body>
</html>
